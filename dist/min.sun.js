function(context,args){ // 
  var __main__;
(()=>{function W(_){if(_===void 0)return!1;for(let C=0;C<_.length;C++){let z=_[C].charCodeAt(0);if(!(z>=48&&z<=57||z>=65&&z<=90||z>=97&&z<=122||"_".includes(_[C])))return!1}return!0}function U(_){let C=[],z=_.split(`
`);for(let G of z){let H=G,J="\/\/";if(G.includes(J))G=G.substring(0,G.indexOf(J));let $=G.split(";");for(let P of $){if(P=P.trim(),!P)continue;let K=o(P);C.push({raw:H,tokens:K})}}return C}function o(_){let z=["->",..."=!:;+-^~>[]*#"];function G(P,K,T){return P.substring(T,T+K.length)==K}let H=" \t\r",J=[],$="";_:for(let P=0;P<_.length;P++){let K=_[P];if(H.includes(K)){while(H.includes(K)){P++,K=_[P];continue}J.push(" ")}for(let O of z)if(G(_,O,P)){J.push(O),P+=O.length-1;continue _}if(K=='"'){let O=K;do P++,K=_[P],O+=K;while(K!='"');J.push(O);continue}let T=K;P++,K=_[P];while(W(K))T+=K,P++,K=_[P];P--,J.push(T)}if(J.length>0&&J[J.length-1]!=";")J.push(";");return J}function D(_,C,z="",G=""){return A(`${z}Expected any of ["${_.join('", "')}"]. But recieved: "${C}". ${G}`)}var h=[],F=h[0],B=0;function N(_){let C=U(_),z=[],G=[];for(let H of C){h=H.tokens,F=h[0],B=0;let J=i();if(J.type=="error")G.push({line:H.raw,error:J.error});else z.push(...J.value)}return{errors:G,parsed:z}}function Z(_){}function M(){if(B++,F=h[B],F===void 0)F=";";return Z("Advanced: "+F),F}function g(_){return h[B+_]}function V(){return B>=h.length}function x(){return{curI:B,cur:F}}function v(_){B=_.curI,F=_.cur}function j(_){if(Z("consume "+_),F!=_)return D([_],F);Z("consumed");let C=F;return M(),X(void 0)}function Y(){while(F==" ")M()}function X(_){return{type:"success",value:_}}function A(_){return Z(_),{type:"error",error:_}}function i(){Z("parseScriptLine"),Y();let _=[];while(!V()){while(F==";")M();if(V())return X(_);let C=t();if(C.type=="error")return C;if(C.value)_.push(C.value)}return X(_)}function t(){Z("parseRule"),Y();let _={_stage:0};if(F==">"){_.return=!0,M(),Y();let z=j(";");if(z.type=="error")return z;return X(_)}if(F=="#"){M();let z=E();if(z.type=="error")return z;if(typeof z.value!="number")return D(["number"],JSON.stringify(z.value),"Stage error. ");_._stage=z.value,Y()}if(F=="alias"){let z=c();if(z.type=="error")return z;return _.alias=z.value,X(_)}let C=s();if(C.type=="error")return C;if(_.filters=C.value,Y(),F==";")return M(),X(_);if(Y(),F=="->"){M();let z=n();if(z.type=="error")return z;_.actions=z.value,Y();let G=j(";");if(G.type=="error")return G}return X(_)}function n(){Z("parseActions");let _=[];while(!0){if(Y(),F==";")return X(_);let C=p();if(C.type=="error")return C;_.push(C.value)}}function p(){Z("parseAction"),Y();let _={};if(!W(F))return D(["alphanumeric string"],F,"Action error. ");let C=F;if(M(),Y(),W(F)||F==";")return X({k:C,v:!0});else if(F=="="){M(),Y();let z=I();if(z.type=="error")return z;let G=z.value;return M(),X({k:C,v:G})}else return D("=; ".split(""),F)}function c(){Z("parseAlias");let _=j("alias");if(_.type=="error")return _;if(_=j(" "),_.type=="error")return _;if(Y(),F.length!=1)return D(["single alphanumeric character"],F,"Alias error. ");let C=F;if(M(),Y(),_=j("="),_.type=="error")return _;if(Y(),!W(F))return D(["alphanumeric string"],F,"Alias error. ");let z=F;if(M(),Y(),_=j(";"),_.type=="error")return _;return X({k:C,v:z})}function s(){Z("parseFilters"),Y();let _=[],C=x(),z=y(),G=r(),H=!1;if(G.type=="error")v(C),H=!0;else{if(z.type=="success"&&z.value===!0)G.value.negative=z.value;_.push(G.value)}Y();while(!(F=="->"||F==";"||V())){let J=y(),$=u();if($.type=="error"&&G.type=="error"&&H)return A(G.error);if($.type=="error")return $;if(J.type=="success"&&J.value===!0)$.value.negative=J.value;_.push($.value),Y(),H=!1}return X(_)}function y(){if(Y(),F=="!")return M(),X(!0);else return X(!1)}function r(){Z("parseSUN");let _={type:"sun",negative:void 0,loaded:void 0,ready:void 0,alias:void 0,tier:void 0,rarity:void 0,value:void 0};if(F=="+")_.loaded=!0,M();else if(F=="-")_.loaded=!1,M();if(F=="^")_.ready=!0,M();else if(F=="~")_.ready=!1,M();if(!W(F)&&F!="*")return D(["alias char"],F,"SUN Rule error. ");switch(F.length){case 3:{if(_.alias=F[0],!isNaN(Number(F[1])))_.tier=Number(F[1]);if(!isNaN(Number(F[2])))_.rarity=Number(F[2]);M()}break;case 2:{if(_.alias=F[0],!isNaN(Number(F[1])))_.tier=Number(F[1]);if(M(),F=="*")j("*");else if(F==" ");else if((F+"").length==1&&!isNaN(Number(F)))_.rarity=Number(F),M()}break;case 1:{if(_.alias=F[0],M(),F=="*")j("*");else if(F==" ");else if((F+"").length==1&&!isNaN(Number(F)))_.tier=Number(F),M();if(F=="*")j("*");else if(F==" ");else if((F+"").length==1&&!isNaN(Number(F)))_.rarity=Number(F),M()}break;default:return D(["alias char"],F,"SUN Rule error. ")}if(_.alias=="*")_.alias=void 0;if(F=="["){j("[");let C=E();if(C.type=="error")return C;if(C.value!="*")_.value=C.value;let z=j("]");if(z.type=="error")return z}if(F!=" "&&F!=";"&&F!="->")return D(["->",";"," "],F,"SUN Rule error. ");if(Y(),_.loaded===void 0)delete _.loaded;if(_.negative===void 0)delete _.negative;if(_.rarity===void 0)delete _.rarity;if(_.ready===void 0)delete _.ready;if(_.tier===void 0)delete _.tier;if(_.value===void 0)delete _.value;return X(_)}function u(){Z("parseLUN");let _={type:"lun",negative:void 0};if(!W(F))return D(["alphanumeric string"],F,"LUN Rule error. ");let C=F;M();let z=x();if(Y(),F=="="){let G=j("=");if(G.type=="error")return G;Y();let H=E();if(H.type=="error")return H;return _[C]=H.value,X(_)}else if([";","->","!"].includes(F)||W(F))return _[C]=!0,X(_);else return D(["=",";","->","!"],F,"LUB Rule error. ")}function E(){if(Z("parseValue"),g(1)==":"){let _=e();if(_.type=="error")return _;if(_.value.min==null&&_.value.max==null)return X(void 0);return _}else{let _=I();if(_.type=="error")return _;if(_.value==null)return X(void 0);return X(_.value)}}function I(){Z("parseValueType");let _=F;if(!isNaN(Number(_)))return M(),X(Number(_));if(_[0]=='"'&&_[_.length-1]=='"')return _=_.replace(/\"/gm,""),M(),X(_);if(W(_)){if(_=="true")_=!0;if(_=="false")_=!1;return M(),X(_)}if(_=="*")return _=void 0,M(),X(_);return A("Failed to parse value "+_)}function e(){let _=I();if(_.type=="error")return _;if(typeof _.value!="number"&&_.value!==void 0)_.value=Number(_.value);let C=j(":");if(C.type=="error")return C;let z=I();if(z.type=="error")return z;if(typeof z.value!="number"&&z.value!==void 0)z.value=Number(z.value);return X({type:"range",min:_.value,max:z.value})}function S(_){let C=N(_);if(C.errors.length>0)throw C.errors;let z=[];for(let H of C.parsed)if(!z.includes(H._stage))z.push(H._stage);z.sort((H,J)=>H-J);let G=[];for(let H of z)G.push(C.parsed.filter((J)=>J._stage==H));return{stages:G}}var w={x:"l0ckbox",j:"l0ckjaw",q:"l0cket",a:"acct_nt",m:"magnara",W:"l0g_wr1t3r",o:"sn_w_usac",f:"shfflr",N:"CON_TELL",n:"CON_SPEC",D:"DATA_CHECK",g:"sn_w_glock","2":"ez_21","3":"ez_35","4":"ez_40",X:"c001",y:"c002",Y:"c003",C:"cron_bot",c:"char_count",s:"script_slot",S:"public_script","0":"channel_count",k:"k3y",b:"balance",w:"log_writer",t:"transactions",T:"transfer",u:"expose_upgrades",U:"transfer_upgrade",l:"expose_access_log",L:"expose_upgrade_log",z:"w4rn",Z:"w4rn_message",r:"w4rn_er"},R,q;function m(_,C){R={};for(let G in w)R[G]=w[G];let z=!1;for(let G of C.stages){q=[..._];for(let H of q)delete H._filtered;for(let H of G){if(H.return){if(q=q.filter((K)=>!K._filtered),q.length==0)break;continue}if(H.alias){R[H.alias.k]=H.alias.v;continue}let J=[];for(let K of q)if(H.filters&&C0(K,H.filters))J.push(K),z=!0;let $=(H.filters||[]).find((K)=>K._best!==void 0),P=(H.filters||[]).find((K)=>K._worst!==void 0);if($&&typeof $._best=="number")J=k(J,$._best,!1,$.negative===!0);else if(P&&typeof P._worst=="number")J=k(J,P._worst,!0,P.negative===!0);for(let K of J)if(K._filtered=!0,H.actions)F0(K,H.actions)}}}function Q(_){return _.replace(/\_v\d$/gm,"").replace(/\_V\d$/gm,"")}function L(_){let C=Q(_.name),z={k3y:_.k3y,CON_SPEC:_.p2_len,acct_nt:_.acct_nt_min,sn_w_glock:_.expire_secs,sn_w_usac:_.salt_digits,magnara:_.magnara_len,shfflr:_.digits,l0g_wr1t3r:_.loc_count,w4rn_message:_.cooldown,DATA_CHECK:_.acc_mod,l0cket:_.count,l0ckbox:_.count,l0ckjaw:_.count,balance:_.cooldown,expose_access_log:_.count,expose_upgrade_log:_.count,expose_upgrades:_.cooldown,log_writer:_.cooldown,transactions:_.count,transfer_upgrade:_.count,transfer:_.amount,channel_count:_.count,char_count:_.chars,public_script:_.slots,script_slot:_.slots,cron_bot:_.cooldown};if(C in z)return z[C];return 0}function f(_){let C=Q(_.name);if(C=="k3y"){if(_.rarity==0)return 3;if(_.rarity==1)return 2;if(_.rarity>=2)return 1}let z={CON_SPEC:_.p2_len,acct_nt:_.acct_nt_min,sn_w_usac:_.salt_digits,magnara:_.magnara_len,shfflr:_.digits,l0g_wr1t3r:_.loc_count,DATA_CHECK:_.acc_mod,l0cket:_.count,l0ckbox:_.count,l0ckjaw:_.count,expose_access_log:_.count,expose_upgrade_log:_.count,transactions:_.count,transfer_upgrade:_.count,transfer:_.amount,channel_count:_.count,char_count:_.chars,public_script:_.slots,script_slot:_.slots,sn_w_glock:-_.expire_secs,w4rn_message:-_.cooldown,balance:-_.cooldown,expose_upgrades:-_.cooldown,log_writer:-_.cooldown,cron_bot:-_.cooldown};if(C in z)return z[C];return 1}function a(_){if(!_.last_time||!_.cooldown)return-1;return _.cooldown*1000-(Date.now()-_.last_time)}function _0(_){return a(_)<=0}function b(_,C){if(C===void 0)return!0;else if(typeof C=="number"||typeof C=="boolean")return _===C;else if(C=="undefined")return _===void 0;else if(typeof C=="string")return _===C;else if(C.type=="range")if(typeof _=="number"){let z=!0;if(_==null)return!1;if(C.min!=null&&_<C.min)z=!1;if(C.max!=null&&_>C.max)z=!1;return z}else return!1;return!1}function z0(_,C){let z=Q(_.name);if(R[C]==z)return!0;return!1}function C0(_,C){for(let z of C){let G=z.negative==!0;if(z.type=="sun"){if(z.alias&&!z0(_,z.alias)!==G)return!1;if(z.ready!=null&&z.ready!=_0(_)!==G)return!1;if(z.value!=null&&!b(L(_),z.value)!==G)return!1}for(let H in z){if(["_best","_worst","alias","ready","value","_stage","type"].includes(H))continue;let J=z[H];if(J!=null&&!b(_[H],J)!==G)return!1}}return!0}function d(_,C){let z=Q(_.name),G=Q(C.name),H=f(_),J=f(C);if(z!=G)return 0;if(z=="k3y"&&_.k3y!=C.k3y)return 0;return J-H}function k(_,C,z,G){if(_.sort(d),z)_.reverse();if(!G)return _.slice(0,C);if(G)return _.slice(C);return[]}function F0(_,C){for(let z of C)if(_[z.k]=z.v,z.v=="undefined")delete _[z.k]}function l(_){return _.sort((C,z)=>{if(C.name!=z.name)return C.name.localeCompare(z.name);let G=d(C,z);if(G!=0)return G;if(C.tier!=z.tier)return z.tier-C.tier;if(C.rarity!=z.rarity)return z.rarity-C.rarity;if(C.loaded!=z.loaded)return z.loaded?1:0;return 0})}function G0(_){if(_&&_.import===!0)return{compile:S,filter:m,sortUpgrades:l,getUpgradeValue:L,getUpgradeQuality:f,Aliases:w};return(`    'J╔══════════════════════════════════════════════════════════════╗'    
    'J║'  cake.sun - Short Upgrade Notation                           'J║'   
    'J╠══════════════════════════════════════════════════════════════╣'    
    'J║'                                                              'J║'   
    'J║'  'I\\ | /                -= SUNSCRIPT =-'                        'J║'
    'J║'  'I- O -        A smart filter for your upgrades'               'J║'
    'J║'  'I/ | \\                 Keep it light'                         'J║'
    'J║'                                                              'J║'   
    'J║'  'IAll info is at https:`+"\/\/"+`github.com/CakeEaterGames/sunscript'  'J║'
    'J║                                                              ║'    
    'J╚══════════════════════════════════════════════════════════════╝'    `).replace(/'/gm,"`")}__main__=G0;})();

  return __main__(args);
}