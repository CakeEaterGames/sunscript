function(context,args){ // 
  var __main__;
(()=>{function W(_){if(_===void 0)return!1;for(let z=0;z<_.length;z++){let G=_[z].charCodeAt(0);if(!(G>=48&&G<=57||G>=65&&G<=90||G>=97&&G<=122||"_".includes(_[z])))return!1}return!0}function L(_){let z=[],G=_.split(`
`);for(let J of G){let K=J,P="\/\/";if(J.includes(P))J=J.substring(0,J.indexOf(P));let M=J.split(";");for(let Z of M){if(Z=Z.trim(),!Z)continue;let X=l(Z);z.push({raw:K,tokens:X})}}return z}function l(_){let G=["->","---",..."=!:;+-^~>[]*"];function J(Z,X,T){return Z.substring(T,T+X.length)==X}let K=" \t\r",P=[],M="";_:for(let Z=0;Z<_.length;Z++){let X=_[Z];if(K.includes(X)){while(K.includes(X)){Z++,X=_[Z];continue}P.push(" ")}for(let O of G)if(J(_,O,Z)){P.push(O),Z+=O.length-1;continue _}if(X=='"'){let O=X;do Z++,X=_[Z],O+=X;while(X!='"');P.push(O);continue}let T=X;Z++,X=_[Z];while(W(X))T+=X,Z++,X=_[Z];Z--,P.push(T)}if(P.length>0&&P[P.length-1]!=";")P.push(";");return P}function B(_,z,G="",J=""){return A(`${G}Expected any of ["${_.join('", "')}"]. But recieved: "${z}". ${J}`)}var h=[],H=h[0],D=0;function x(_){let z=L(_),G=[],J=[];for(let K of z){h=K.tokens,H=h[0],D=0;let P=t();if(P.type=="error")J.push({line:K.raw,error:P.error});else G.push(...P.value)}return{errors:J,parsed:G}}function F(_){}function Y(){if(D++,H=h[D],H===void 0)H=";";return F("Advanced: "+H),H}function v(_){return h[D+_]}function f(){return D>=h.length}function S(){return{curI:D,cur:H}}function i(_){D=_.curI,H=_.cur}function C(_){if(F("consume "+_),H!=_)return B([_],H);F("consumed");let z=H;return Y(),$(void 0)}function j(){while(H==" ")Y()}function $(_){return{type:"success",value:_}}function A(_){return F(_),{type:"error",error:_}}function t(){F("parseScriptLine"),j();let _=[];while(!f()){while(H==";")Y();if(f())return $(_);let z=n();if(z.type=="error")return z;if(z.value)_.push(z.value)}return $(_)}function n(){F("parseCMD"),j();let _={};if(H==">"){_.type="return",Y(),j();let J=C(";");if(J.type=="error")return J;return $(_)}if(H=="---"){_.type="stage",Y(),j();let J=C(";");if(J.type=="error")return J;return $(_)}if(H=="alias"){_.type="alias";let J=s();if(J.type=="error")return J;return _.data=J.value,$(_)}let z={};_.type="rule",_.data=z;let G=r();if(G.type=="error")return G;if(z.filters=G.value,j(),H==";")return Y(),$(_);if(j(),H=="->"){Y();let J=p();if(J.type=="error")return J;z.actions=J.value,j();let K=C(";");if(K.type=="error")return K}if(z.actions&&z.actions.length==0)delete z.actions;if(z.filters&&z.filters.length==0)delete z.filters;return $(_)}function p(){F("parseActions");let _=[];while(!0){if(j(),H==";")return $(_);let z=c();if(z.type=="error")return z;_.push(z.value)}}function c(){F("parseAction"),j();let _={};if(!W(H))return B(["alphanumeric string"],H,"Action error. ");let z=H;if(Y(),j(),W(H)||H==";")return $({k:z,v:!0});else if(H=="="){Y(),j();let G=q();if(G.type=="error")return G;let J=G.value;return Y(),$({k:z,v:J})}else return B("=; ".split(""),H)}function s(){F("parseAlias");let _=C("alias");if(_.type=="error")return _;if(_=C(" "),_.type=="error")return _;if(j(),H.length!=1)return B(["single alphanumeric character"],H,"Alias error. ");let z=H;if(Y(),j(),_=C("="),_.type=="error")return _;if(j(),!W(H))return B(["alphanumeric string"],H,"Alias error. ");let G=H;if(Y(),j(),_=C(";"),_.type=="error")return _;return $({k:z,v:G})}function r(){F("parseFilters"),j();let _=[],z=S(),G=U(),J=u(),K=!1;if(J.type=="error")i(z),K=!0;else{if(G.type=="success"&&G.value===!0)J.value.negative=G.value;_.push(J.value)}j();while(!(H=="->"||H==";"||f())){let P=U(),M=a();if(M.type=="error"&&J.type=="error"&&K)return A(J.error);if(M.type=="error")return M;if(P.type=="success"&&P.value===!0)M.value.negative=P.value;_.push(M.value),j(),K=!1}return $(_)}function U(){if(j(),H=="!")return Y(),$(!0);else return $(!1)}function u(){F("parseSUN");let _={filterType:"sun",negative:void 0,loaded:void 0,ready:void 0,alias:void 0,tier:void 0,rarity:void 0,value:void 0};if(H=="+")_.loaded=!0,Y();else if(H=="-")_.loaded=!1,Y();if(H=="^")_.ready=!0,Y();else if(H=="~")_.ready=!1,Y();if(!W(H)&&H!="*")return B(["alias char"],H,"SUN Rule error. ");switch(H.length){case 3:{if(_.alias=H[0],!isNaN(Number(H[1])))_.tier=Number(H[1]);if(!isNaN(Number(H[2])))_.rarity=Number(H[2]);Y()}break;case 2:{if(_.alias=H[0],!isNaN(Number(H[1])))_.tier=Number(H[1]);if(Y(),H=="*")C("*");else if(H==" ");else if((H+"").length==1&&!isNaN(Number(H)))_.rarity=Number(H),Y()}break;case 1:{if(_.alias=H[0],Y(),H=="*")C("*");else if(H==" ");else if((H+"").length==1&&!isNaN(Number(H)))_.tier=Number(H),Y();if(H=="*")C("*");else if(H==" ");else if((H+"").length==1&&!isNaN(Number(H)))_.rarity=Number(H),Y()}break;default:return B(["alias char"],H,"SUN Rule error. ")}if(_.alias=="*")_.alias=void 0;if(H=="["){C("[");let z=b();if(z.type=="error")return z;if(z.value!="*")_.value=z.value;let G=C("]");if(G.type=="error")return G}if(H!=" "&&H!=";"&&H!="->")return B(["->",";"," "],H,"SUN Rule error. ");if(j(),_.loaded===void 0)delete _.loaded;if(_.negative===void 0)delete _.negative;if(_.rarity===void 0)delete _.rarity;if(_.ready===void 0)delete _.ready;if(_.tier===void 0)delete _.tier;if(_.value===void 0)delete _.value;return $(_)}function a(){F("parseLUN");let _={filterType:"lun",negative:void 0};if(!W(H))return B(["alphanumeric string"],H,"LUN Rule error. ");let z=H;Y();let G=S();if(j(),H=="="){let J=C("=");if(J.type=="error")return J;j();let K=b();if(K.type=="error")return K;return _[z]=K.value,$(_)}else if([";","->","!"].includes(H)||W(H))return _[z]=!0,$(_);else return B(["=",";","->","!"],H,"LUB Rule error. ")}function b(){if(F("parseValue"),v(1)==":"){let _=e();if(_.type=="error")return _;if(_.value.min==null&&_.value.max==null)return $(void 0);return _}else{let _=q();if(_.type=="error")return _;if(_.value==null)return $(void 0);return $(_.value)}}function q(){F("parseValueType");let _=H;if(!isNaN(Number(_)))return Y(),$(Number(_));if(_[0]=='"'&&_[_.length-1]=='"')return _=_.replace(/\"/gm,""),Y(),$(_);if(W(_)){if(_=="true")_=!0;if(_=="false")_=!1;return Y(),$(_)}if(_=="*")return _=void 0,Y(),$(_);return A("Failed to parse value "+_)}function e(){let _=q();if(_.type=="error")return _;if(typeof _.value!="number"&&_.value!==void 0)_.value=Number(_.value);let z=C(":");if(z.type=="error")return z;let G=q();if(G.type=="error")return G;if(typeof G.value!="number"&&G.value!==void 0)G.value=Number(G.value);return $({type:"range",min:_.value,max:G.value})}function w(_){let z=x(_);if(z.errors.length>0)throw z.errors;let G={stages:[]},J=[];for(let K=0;K<z.parsed.length;K++){let P=z.parsed[K];if(P.type=="stage")G.stages.push(J),J=[];else J.push(P);if(K==z.parsed.length-1)G.stages.push(J)}return G}var V={x:"l0ckbox",j:"l0ckjaw",q:"l0cket",a:"acct_nt",m:"magnara",W:"l0g_wr1t3r",o:"sn_w_usac",f:"shfflr",N:"CON_TELL",n:"CON_SPEC",D:"DATA_CHECK",g:"sn_w_glock","2":"ez_21","3":"ez_35","4":"ez_40",X:"c001",y:"c002",Y:"c003",C:"cron_bot",c:"char_count",s:"script_slot",S:"public_script","0":"channel_count",k:"k3y",b:"balance",w:"log_writer",t:"transactions",T:"transfer",u:"expose_upgrades",U:"transfer_upgrade",l:"expose_access_log",L:"expose_upgrade_log",z:"w4rn",Z:"w4rn_message",r:"w4rn_er"},I,R;function o(_,z){return E(_,w(z))}function E(_,z){I={};for(let J in V)I[J]=V[J];let G=[];for(let J of z.stages){R=[..._];for(let K of R)delete K._filtered;for(let K of J){if(K.type=="return"){if(R=R.filter((P)=>!P._filtered),R.length==0)break;continue}if(K.type=="alias"){I[K.data.k]=K.data.v;continue}if(K.type="rule"){if(!K.data)throw Error("Wtf?");let P=[];for(let X of R){if(!K.data.filters){P.push(X);continue}if(H0(X,K.data.filters))P.push(X)}let M=(K.data.filters||[]).find((X)=>X._best!==void 0),Z=(K.data.filters||[]).find((X)=>X._worst!==void 0);if(M&&typeof M._best=="number")P=k(P,M._best,!1,M.negative===!0);else if(Z&&typeof Z._worst=="number")P=k(P,Z._worst,!0,Z.negative===!0);for(let X of P){if(!G.includes(X))G.push(X);if(X._filtered=!0,K.data.actions)J0(X,K.data.actions)}}}}for(let J of _)delete J._filtered;return G}function Q(_){return _.replace(/\_v\d$/gm,"").replace(/\_V\d$/gm,"")}function y(_){if(!_.name)return 0;let z=Q(_.name),G={k3y:_.k3y,CON_SPEC:_.p2_len,acct_nt:_.acct_nt_min,sn_w_glock:_.expire_secs,sn_w_usac:_.salt_digits,magnara:_.magnara_len,shfflr:_.digits,l0g_wr1t3r:_.loc_count,w4rn_message:_.cooldown,DATA_CHECK:_.acc_mod,l0cket:_.count,l0ckbox:_.count,l0ckjaw:_.count,balance:_.cooldown,expose_access_log:_.count,expose_upgrade_log:_.count,expose_upgrades:_.cooldown,log_writer:_.cooldown,transactions:_.count,transfer_upgrade:_.count,transfer:_.amount,channel_count:_.count,char_count:_.chars,public_script:_.slots,script_slot:_.slots,cron_bot:_.cooldown};if(z in G)return G[z];return 0}function N(_){if(!_.name)return 0;let z=Q(_.name);if(z=="k3y"){if(!_.rarity)return 0;if(_.rarity==0)return 3;if(_.rarity==1)return 2;if(_.rarity>=2)return 1}let G={CON_SPEC:_.p2_len,acct_nt:_.acct_nt_min,sn_w_usac:_.salt_digits,magnara:_.magnara_len,shfflr:_.digits,l0g_wr1t3r:_.loc_count,DATA_CHECK:_.acc_mod,l0cket:_.count,l0ckbox:_.count,l0ckjaw:_.count,expose_access_log:_.count,expose_upgrade_log:_.count,transactions:_.count,transfer_upgrade:_.count,transfer:_.amount,channel_count:_.count,char_count:_.chars,public_script:_.slots,script_slot:_.slots,sn_w_glock:-_.expire_secs,w4rn_message:-_.cooldown,balance:-_.cooldown,expose_upgrades:-_.cooldown,log_writer:-_.cooldown,cron_bot:-_.cooldown};if(z in G)return G[z];return 1}function _0(_){if(!_.last_time||!_.cooldown)return-1;return _.cooldown*1000-(Date.now()-_.last_time)}function z0(_){return _0(_)<=0}function m(_,z){if(z===void 0)return!0;else if(typeof z=="number"||typeof z=="boolean")return _===z;else if(z=="undefined")return _===void 0;else if(typeof z=="string")return _===z;else if(z.type=="range")if(typeof _=="number"){let G=!0;if(_==null)return!1;if(z.min!=null&&_<z.min)G=!1;if(z.max!=null&&_>z.max)G=!1;return G}else return!1;return!1}function G0(_,z){if(!_.name)return!1;let G=Q(_.name);if(I[z]==G)return!0;return!1}function H0(_,z){for(let G of z){let J=G.negative==!0;if(G.filterType=="sun"){if(G.alias&&!G0(_,G.alias)!==J)return!1;if(G.ready!=null&&G.ready!=z0(_)!==J)return!1;if(G.value!=null&&!m(y(_),G.value)!==J)return!1}for(let K in G){if(["_best","_worst","alias","ready","value","next_stage","filterType"].includes(K))continue;let P=G[K];if(P!=null&&!m(_[K],P)!==J)return!1}}return!0}function d(_,z){if(!_.name)return 0;if(!z.name)return 0;let G=Q(_.name),J=Q(z.name),K=N(_),P=N(z);if(G!=J)return 0;if(G=="k3y"&&_.k3y!=z.k3y)return 0;if(P!=K)return P-K;if(_.sn&&z.sn)return _.sn.localeCompare(z.sn);return 0}function k(_,z,G,J){if(_.sort(d),G)_.reverse();if(!J)return _.slice(0,z);if(J)return _.slice(z);return[]}function J0(_,z){for(let G of z)if(_[G.k]=G.v,G.v=="undefined")delete _[G.k]}function g(_){return _.sort((z,G)=>{if(z.name!==void 0&&G.name!==void 0&&z.name!=G.name)return z.name.localeCompare(G.name);let J=d(z,G);if(J!=0)return J;if(z.tier!==void 0&&G.tier!==void 0&&z.tier!=G.tier)return G.tier-z.tier;if(z.rarity!==void 0&&G.rarity!==void 0&&z.rarity!=G.rarity)return G.rarity-z.rarity;if(z.loaded!==void 0&&G.loaded!==void 0&&z.loaded!=G.loaded)return G.loaded?1:0;return 0})}function K0(_){if(_&&_.import===!0)return{compile:w,filter:E,compileAndFilter:o,sortUpgrades:g,getUpgradeValue:y,getUpgradeQuality:N,Aliases:V};return(`    'J╔══════════════════════════════════════════════════════════════╗'    
    'J║'  cake.sun - Short Upgrade Notation                           'J║'   
    'J╠══════════════════════════════════════════════════════════════╣'    
    'J║'                                                              'J║'   
    'J║'  'I\\ | /                -= SUNSCRIPT =-'                        'J║'
    'J║'  'I- O -        A smart filter for your upgrades'               'J║'
    'J║'  'I/ | \\                 Keep it light'                         'J║'
    'J║'                                                              'J║'   
    'J║'  'IAll info is at https:`+"\/\/"+`github.com/CakeEaterGames/sunscript'  'J║'
    'J║                                                              ║'    
    'J╚══════════════════════════════════════════════════════════════╝'    `).replace(/'/gm,"`")}__main__=K0;})();

  return __main__(args);
}