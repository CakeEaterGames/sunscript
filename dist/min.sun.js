function(context,args){ // 
  var __main__;
(()=>{function W(_){if(_===void 0)return!1;for(let z=0;z<_.length;z++){let F=_[z].charCodeAt(0);if(!(F>=48&&F<=57||F>=65&&F<=90||F>=97&&F<=122||"_".includes(_[z])))return!1}return!0}function E(_){let z=[],F=_.split(`
`);for(let H of F){let J=H,K="\/\/";if(H.includes(K))H=H.substring(0,H.indexOf(K));let M=H.split(";");for(let Y of M){if(Y=Y.trim(),!Y)continue;let P=l(Y);z.push({raw:J,tokens:P})}}return z}function l(_){let F=["->","---",..."=!:;+-^~>[]*"];function H(Y,P,R){return Y.substring(R,R+P.length)==P}let J=" \t\r",K=[],M="";_:for(let Y=0;Y<_.length;Y++){let P=_[Y];if(J.includes(P)){while(J.includes(P)){Y++,P=_[Y];continue}K.push(" ")}for(let O of F)if(H(_,O,Y)){K.push(O),Y+=O.length-1;continue _}if(P=='"'){let O=P;do Y++,P=_[Y],O+=P;while(P!='"');K.push(O);continue}let R=P;Y++,P=_[Y];while(W(P))R+=P,Y++,P=_[Y];Y--,K.push(R)}if(K.length>0&&K[K.length-1]!=";")K.push(";");return K}function B(_,z,F="",H=""){return f(`${F}Expected any of ["${_.join('", "')}"]. But recieved: "${z}". ${H}`)}var h=[],G=h[0],D=0;function U(_){let z=E(_),F=[],H=[];for(let J of z){h=J.tokens,G=h[0],D=0;let K=i();if(K.type=="error")H.push({line:J.raw,error:K.error});else F.push(...K.value)}return{errors:H,parsed:F}}function C(_){}function X(){if(D++,G=h[D],G===void 0)G=";";return C("Advanced: "+G),G}function g(_){return h[D+_]}function N(){return D>=h.length}function y(){return{curI:D,cur:G}}function v(_){D=_.curI,G=_.cur}function j(_){if(C("consume "+_),G!=_)return B([_],G);C("consumed");let z=G;return X(),Z(void 0)}function $(){while(G==" ")X()}function Z(_){return{type:"success",value:_}}function f(_){return C(_),{type:"error",error:_}}function i(){C("parseScriptLine"),$();let _=[];while(!N()){while(G==";")X();if(N())return Z(_);let z=t();if(z.type=="error")return z;if(z.value)_.push(z.value)}return Z(_)}function t(){C("parseCMD"),$();let _={};if(G==">"){_.type="return",X(),$();let H=j(";");if(H.type=="error")return H;return Z(_)}if(G=="---"){_.type="stage",X(),$();let H=j(";");if(H.type=="error")return H;return Z(_)}if(G=="alias"){_.type="alias";let H=c();if(H.type=="error")return H;return _.data=H.value,Z(_)}let z={};_.type="rule",_.data=z;let F=s();if(F.type=="error")return F;if(z.filters=F.value,$(),G==";")return X(),Z(_);if($(),G=="->"){X();let H=n();if(H.type=="error")return H;z.actions=H.value,$();let J=j(";");if(J.type=="error")return J}if(z.actions&&z.actions.length==0)delete z.actions;if(z.filters&&z.filters.length==0)delete z.filters;return Z(_)}function n(){C("parseActions");let _=[];while(!0){if($(),G==";")return Z(_);let z=p();if(z.type=="error")return z;_.push(z.value)}}function p(){C("parseAction"),$();let _={};if(!W(G))return B(["alphanumeric string"],G,"Action error. ");let z=G;if(X(),$(),W(G)||G==";")return Z({k:z,v:!0});else if(G=="="){X(),$();let F=Q();if(F.type=="error")return F;let H=F.value;return X(),Z({k:z,v:H})}else return B("=; ".split(""),G)}function c(){C("parseAlias");let _=j("alias");if(_.type=="error")return _;if(_=j(" "),_.type=="error")return _;if($(),G.length!=1)return B(["single alphanumeric character"],G,"Alias error. ");let z=G;if(X(),$(),_=j("="),_.type=="error")return _;if($(),!W(G))return B(["alphanumeric string"],G,"Alias error. ");let F=G;if(X(),$(),_=j(";"),_.type=="error")return _;return Z({k:z,v:F})}function s(){C("parseFilters"),$();let _=[],z=y(),F=L(),H=r(),J=!1;if(H.type=="error")v(z),J=!0;else{if(F.type=="success"&&F.value===!0)H.value.negative=F.value;_.push(H.value)}$();while(!(G=="->"||G==";"||N())){let K=L(),M=u();if(M.type=="error"&&H.type=="error"&&J)return f(H.error);if(M.type=="error")return M;if(K.type=="success"&&K.value===!0)M.value.negative=K.value;_.push(M.value),$(),J=!1}return Z(_)}function L(){if($(),G=="!")return X(),Z(!0);else return Z(!1)}function r(){C("parseSUN");let _={type:"sun",negative:void 0,loaded:void 0,ready:void 0,alias:void 0,tier:void 0,rarity:void 0,value:void 0};if(G=="+")_.loaded=!0,X();else if(G=="-")_.loaded=!1,X();if(G=="^")_.ready=!0,X();else if(G=="~")_.ready=!1,X();if(!W(G)&&G!="*")return B(["alias char"],G,"SUN Rule error. ");switch(G.length){case 3:{if(_.alias=G[0],!isNaN(Number(G[1])))_.tier=Number(G[1]);if(!isNaN(Number(G[2])))_.rarity=Number(G[2]);X()}break;case 2:{if(_.alias=G[0],!isNaN(Number(G[1])))_.tier=Number(G[1]);if(X(),G=="*")j("*");else if(G==" ");else if((G+"").length==1&&!isNaN(Number(G)))_.rarity=Number(G),X()}break;case 1:{if(_.alias=G[0],X(),G=="*")j("*");else if(G==" ");else if((G+"").length==1&&!isNaN(Number(G)))_.tier=Number(G),X();if(G=="*")j("*");else if(G==" ");else if((G+"").length==1&&!isNaN(Number(G)))_.rarity=Number(G),X()}break;default:return B(["alias char"],G,"SUN Rule error. ")}if(_.alias=="*")_.alias=void 0;if(G=="["){j("[");let z=x();if(z.type=="error")return z;if(z.value!="*")_.value=z.value;let F=j("]");if(F.type=="error")return F}if(G!=" "&&G!=";"&&G!="->")return B(["->",";"," "],G,"SUN Rule error. ");if($(),_.loaded===void 0)delete _.loaded;if(_.negative===void 0)delete _.negative;if(_.rarity===void 0)delete _.rarity;if(_.ready===void 0)delete _.ready;if(_.tier===void 0)delete _.tier;if(_.value===void 0)delete _.value;return Z(_)}function u(){C("parseLUN");let _={type:"lun",negative:void 0};if(!W(G))return B(["alphanumeric string"],G,"LUN Rule error. ");let z=G;X();let F=y();if($(),G=="="){let H=j("=");if(H.type=="error")return H;$();let J=x();if(J.type=="error")return J;return _[z]=J.value,Z(_)}else if([";","->","!"].includes(G)||W(G))return _[z]=!0,Z(_);else return B(["=",";","->","!"],G,"LUB Rule error. ")}function x(){if(C("parseValue"),g(1)==":"){let _=a();if(_.type=="error")return _;if(_.value.min==null&&_.value.max==null)return Z(void 0);return _}else{let _=Q();if(_.type=="error")return _;if(_.value==null)return Z(void 0);return Z(_.value)}}function Q(){C("parseValueType");let _=G;if(!isNaN(Number(_)))return X(),Z(Number(_));if(_[0]=='"'&&_[_.length-1]=='"')return _=_.replace(/\"/gm,""),X(),Z(_);if(W(_)){if(_=="true")_=!0;if(_=="false")_=!1;return X(),Z(_)}if(_=="*")return _=void 0,X(),Z(_);return f("Failed to parse value "+_)}function a(){let _=Q();if(_.type=="error")return _;if(typeof _.value!="number"&&_.value!==void 0)_.value=Number(_.value);let z=j(":");if(z.type=="error")return z;let F=Q();if(F.type=="error")return F;if(typeof F.value!="number"&&F.value!==void 0)F.value=Number(F.value);return Z({type:"range",min:_.value,max:F.value})}function S(_){let z=U(_);if(z.errors.length>0)throw z.errors;let F={stages:[]},H=[];for(let J=0;J<z.parsed.length;J++){let K=z.parsed[J];if(K.type=="stage")F.stages.push(H),H=[];else H.push(K);if(J==z.parsed.length-1)F.stages.push(H)}return F}var w={x:"l0ckbox",j:"l0ckjaw",q:"l0cket",a:"acct_nt",m:"magnara",W:"l0g_wr1t3r",o:"sn_w_usac",f:"shfflr",N:"CON_TELL",n:"CON_SPEC",D:"DATA_CHECK",g:"sn_w_glock","2":"ez_21","3":"ez_35","4":"ez_40",X:"c001",y:"c002",Y:"c003",C:"cron_bot",c:"char_count",s:"script_slot",S:"public_script","0":"channel_count",k:"k3y",b:"balance",w:"log_writer",t:"transactions",T:"transfer",u:"expose_upgrades",U:"transfer_upgrade",l:"expose_access_log",L:"expose_upgrade_log",z:"w4rn",Z:"w4rn_message",r:"w4rn_er"},I,q;function k(_,z){I={};for(let H in w)I[H]=w[H];let F=[];for(let H of z.stages){q=[..._];for(let J of q)delete J._filtered;for(let J of H){if(J.type=="return"){if(q=q.filter((K)=>!K._filtered),q.length==0)break;continue}if(J.type=="alias"){I[J.data.k]=J.data.v;continue}if(J.type="rule"){if(!J.data)throw Error("Wtf?");let K=[];for(let P of q){if(!J.data.filters){K.push(P);continue}if(F0(P,J.data.filters))K.push(P)}let M=(J.data.filters||[]).find((P)=>P._best!==void 0),Y=(J.data.filters||[]).find((P)=>P._worst!==void 0);if(M&&typeof M._best=="number")K=m(K,M._best,!1,M.negative===!0);else if(Y&&typeof Y._worst=="number")K=m(K,Y._worst,!0,Y.negative===!0);for(let P of K){if(!F.includes(P))F.push(P);if(P._filtered=!0,J.data.actions)G0(P,J.data.actions)}}}}for(let H of _)delete H._filtered;return F}function T(_){return _.replace(/\_v\d$/gm,"").replace(/\_V\d$/gm,"")}function A(_){let z=T(_.name),F={k3y:_.k3y,CON_SPEC:_.p2_len,acct_nt:_.acct_nt_min,sn_w_glock:_.expire_secs,sn_w_usac:_.salt_digits,magnara:_.magnara_len,shfflr:_.digits,l0g_wr1t3r:_.loc_count,w4rn_message:_.cooldown,DATA_CHECK:_.acc_mod,l0cket:_.count,l0ckbox:_.count,l0ckjaw:_.count,balance:_.cooldown,expose_access_log:_.count,expose_upgrade_log:_.count,expose_upgrades:_.cooldown,log_writer:_.cooldown,transactions:_.count,transfer_upgrade:_.count,transfer:_.amount,channel_count:_.count,char_count:_.chars,public_script:_.slots,script_slot:_.slots,cron_bot:_.cooldown};if(z in F)return F[z];return 0}function V(_){let z=T(_.name);if(z=="k3y"){if(_.rarity==0)return 3;if(_.rarity==1)return 2;if(_.rarity>=2)return 1}let F={CON_SPEC:_.p2_len,acct_nt:_.acct_nt_min,sn_w_usac:_.salt_digits,magnara:_.magnara_len,shfflr:_.digits,l0g_wr1t3r:_.loc_count,DATA_CHECK:_.acc_mod,l0cket:_.count,l0ckbox:_.count,l0ckjaw:_.count,expose_access_log:_.count,expose_upgrade_log:_.count,transactions:_.count,transfer_upgrade:_.count,transfer:_.amount,channel_count:_.count,char_count:_.chars,public_script:_.slots,script_slot:_.slots,sn_w_glock:-_.expire_secs,w4rn_message:-_.cooldown,balance:-_.cooldown,expose_upgrades:-_.cooldown,log_writer:-_.cooldown,cron_bot:-_.cooldown};if(z in F)return F[z];return 1}function e(_){if(!_.last_time||!_.cooldown)return-1;return _.cooldown*1000-(Date.now()-_.last_time)}function _0(_){return e(_)<=0}function b(_,z){if(z===void 0)return!0;else if(typeof z=="number"||typeof z=="boolean")return _===z;else if(z=="undefined")return _===void 0;else if(typeof z=="string")return _===z;else if(z.type=="range")if(typeof _=="number"){let F=!0;if(_==null)return!1;if(z.min!=null&&_<z.min)F=!1;if(z.max!=null&&_>z.max)F=!1;return F}else return!1;return!1}function z0(_,z){let F=T(_.name);if(I[z]==F)return!0;return!1}function F0(_,z){for(let F of z){let H=F.negative==!0;if(F.type=="sun"){if(F.alias&&!z0(_,F.alias)!==H)return!1;if(F.ready!=null&&F.ready!=_0(_)!==H)return!1;if(F.value!=null&&!b(A(_),F.value)!==H)return!1}for(let J in F){if(["_best","_worst","alias","ready","value","next_stage","type"].includes(J))continue;let K=F[J];if(K!=null&&!b(_[J],K)!==H)return!1}}return!0}function o(_,z){let F=T(_.name),H=T(z.name),J=V(_),K=V(z);if(F!=H)return 0;if(F=="k3y"&&_.k3y!=z.k3y)return 0;return K-J}function m(_,z,F,H){if(_.sort(o),F)_.reverse();if(!H)return _.slice(0,z);if(H)return _.slice(z);return[]}function G0(_,z){for(let F of z)if(_[F.k]=F.v,F.v=="undefined")delete _[F.k]}function d(_){return _.sort((z,F)=>{if(z.name!=F.name)return z.name.localeCompare(F.name);let H=o(z,F);if(H!=0)return H;if(z.tier!=F.tier)return F.tier-z.tier;if(z.rarity!=F.rarity)return F.rarity-z.rarity;if(z.loaded!=F.loaded)return F.loaded?1:0;return 0})}function H0(_){if(_&&_.import===!0)return{compile:S,filter:k,sortUpgrades:d,getUpgradeValue:A,getUpgradeQuality:V,Aliases:w};return(`    'J╔══════════════════════════════════════════════════════════════╗'    
    'J║'  cake.sun - Short Upgrade Notation                           'J║'   
    'J╠══════════════════════════════════════════════════════════════╣'    
    'J║'                                                              'J║'   
    'J║'  'I\\ | /                -= SUNSCRIPT =-'                        'J║'
    'J║'  'I- O -        A smart filter for your upgrades'               'J║'
    'J║'  'I/ | \\                 Keep it light'                         'J║'
    'J║'                                                              'J║'   
    'J║'  'IAll info is at https:`+"\/\/"+`github.com/CakeEaterGames/sunscript'  'J║'
    'J║                                                              ║'    
    'J╚══════════════════════════════════════════════════════════════╝'    `).replace(/'/gm,"`")}__main__=H0;})();

  return __main__(args);
}