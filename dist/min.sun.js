function(context,args){ // 
  var __main__;
(()=>{function h(t){if(t===void 0)return!1;for(let o=0;o<t.length;o++){let n=t[o].charCodeAt(0);if(!(n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122||"_".includes(t[o])))return!1}return!0}function x(t){let o=[],n=t.split(`
`);for(let l of n){let f=l,i="\/\/";if(l.includes(i))l=l.substring(0,l.indexOf(i));let m=l.split(";");for(let _ of m){if(_=_.trim(),!_)continue;let g=M(_);o.push({raw:f,tokens:g})}}return o}function M(t){let n=["->",..."=!:;+-^~>[]*"];function l(_,g,T){return _.substring(T,T+g.length)==g}let f=" \t\r",i=[],m="";t:for(let _=0;_<t.length;_++){let g=t[_];if(f.includes(g)){while(f.includes(g)){_++,g=t[_];continue}i.push(" ")}for(let O of n)if(l(t,O,_)){i.push(O),_+=O.length-1;continue t}if(g=='"'){let O=g;do _++,g=t[_],O+=g;while(g!='"');i.push(O);continue}let T=g;_++,g=t[_];while(h(g))T+=g,_++,g=t[_];_--,i.push(T)}if(i.length>0&&i[i.length-1]!=";")i.push(";");return i}function U(t,o,n="",l=""){return K(`${n}Expected any of ["${t.join('", "')}"]. But recieved: "${o}". ${l}`)}var D=[],e=D[0],C=0;function $(t){let o=x(t),n=[],l=[];for(let f of o){D=f.tokens,e=D[0],C=0;let i=V();if(i.type=="error")l.push({line:f.raw,error:i.error});else n.push(...i.value)}return{errors:l,parsed:n}}function b(t){}function d(){if(C++,e=D[C],e===void 0)e=";";return b("Advanced: "+e),e}function a(t){return D[C+t]}function H(){return C>=D.length}function B(){return{curI:C,cur:e}}function N(t){C=t.curI,e=t.cur}function y(t){if(b("consume "+t),e!=t)return U([t],e);b("consumed");let o=e;return d(),r(void 0)}function w(){while(e==" ")d()}function r(t){return{type:"success",value:t}}function K(t){return b(t),{type:"error",error:t}}function V(){b("parseScriptLine"),w();let t=[];while(!H()){while(e==";")d();if(H())return r(t);let o=E();if(o.type=="error")return o;if(o.value)t.push(o.value)}return r(t)}function E(){b("parseRule"),w();let t={};if(e==">"){t.return=!0,d(),w();let n=y(";");if(n.type=="error")return n;return r(t)}if(e=="pp"){d(),t.pp=!0;let n=y(" ");if(n.type=="error")return n;w()}if(e=="alias"){let n=c();if(n.type=="error")return n;return t.alias=n.value,r(t)}let o=k();if(o.type=="error")return o;if(t.filters=o.value,w(),e==";")return d(),r(t);if(w(),e=="->"){d();let n=I();if(n.type=="error")return n;t.actions=n.value,w();let l=y(";");if(l.type=="error")return l}return r(t)}function I(){b("parseActions");let t=[];while(!0){if(w(),e==";")return r(t);let o=L();if(o.type=="error")return o;t.push(o.value)}}function L(){b("parseAction"),w();let t={};if(!h(e))return U(["alphanumeric string"],e,"Action error. ");let o=e;if(d(),w(),h(e)||e==";")return r({k:o,v:!0});else if(e=="="){d(),w();let n=j();if(n.type=="error")return n;let l=n.value;return d(),r({k:o,v:l})}else return U("=; ".split(""),e)}function c(){b("parseAlias");let t=y("alias");if(t.type=="error")return t;if(t=y(" "),t.type=="error")return t;if(w(),e.length!=1)return U(["single alphanumeric character"],e,"Alias error. ");let o=e;if(d(),w(),t=y("="),t.type=="error")return t;if(w(),!h(e))return U(["alphanumeric string"],e,"Alias error. ");let n=e;if(d(),w(),t=y(";"),t.type=="error")return t;return r({k:o,v:n})}function k(){b("parseFilters"),w();let t=[],o=B(),n=R(),l=S(),f=!1;if(l.type=="error")N(o),f=!0;else{if(n.type=="success"&&n.value===!0)l.value.negative=n.value;t.push(l.value)}w();while(!(e=="->"||e==";"||H())){let i=R(),m=u();if(m.type=="error"&&l.type=="error"&&f)return K(l.error);if(m.type=="error")return m;if(i.type=="success"&&i.value===!0)m.value.negative=i.value;t.push(m.value),w(),f=!1}return r(t)}function R(){if(w(),e=="!")return d(),r(!0);else return r(!1)}function S(){b("parseSUN");let t={type:"sun",negative:void 0,loaded:void 0,ready:void 0,alias:void 0,tier:void 0,rarity:void 0,value:void 0};if(e=="+")t.loaded=!0,d();else if(e=="-")t.loaded=!1,d();if(e=="^")t.ready=!0,d();else if(e=="~")t.ready=!1,d();if(!h(e)&&e!="*")return U(["alias char"],e,"SUN Rule error. ");switch(e.length){case 3:{if(t.alias=e[0],!isNaN(Number(e[1])))t.tier=Number(e[1]);if(!isNaN(Number(e[2])))t.rarity=Number(e[2]);d()}break;case 2:{if(t.alias=e[0],!isNaN(Number(e[1])))t.tier=Number(e[1]);if(d(),e=="*")y("*");else if(e==" ");else if((e+"").length==1&&!isNaN(Number(e)))t.rarity=Number(e),d()}break;case 1:{if(t.alias=e[0],d(),e=="*")y("*");else if(e==" ");else if((e+"").length==1&&!isNaN(Number(e)))t.tier=Number(e),d();if(e=="*")y("*");else if(e==" ");else if((e+"").length==1&&!isNaN(Number(e)))t.rarity=Number(e),d()}break;default:return U(["alias char"],e,"SUN Rule error. ")}if(t.alias=="*")t.alias=void 0;if(e=="["){y("[");let o=Q();if(o.type=="error")return o;if(o.value!="*")t.value=o.value;let n=y("]");if(n.type=="error")return n}if(e!=" "&&e!=";"&&e!="->")return U(["->",";"," "],e,"SUN Rule error. ");if(d(),t.loaded===void 0)delete t.loaded;if(t.negative===void 0)delete t.negative;if(t.rarity===void 0)delete t.rarity;if(t.ready===void 0)delete t.ready;if(t.tier===void 0)delete t.tier;if(t.value===void 0)delete t.value;return r(t)}function u(){b("parseLUN");let t={type:"lun",negative:void 0};if(!h(e))return U(["alphanumeric string"],e,"LUN Rule error. ");let o=e;d();let n=B();if(w(),e=="="){let l=y("=");if(l.type=="error")return l;w();let f=Q();if(f.type=="error")return f;return t[o]=f.value,r(t)}else if([";","->","!"].includes(e)||h(e))return t[o]=!0,r(t);else return U(["=",";","->","!"],e,"LUB Rule error. ")}function Q(){if(b("parseValue"),a(1)==":"){let t=p();if(t.type=="error")return t;if(t.value.min==null&&t.value.max==null)return r(void 0);return t}else{let t=j();if(t.type=="error")return t;if(t.value==null)return r(void 0);return r(t.value)}}function j(){b("parseValueType");let t=e;if(!isNaN(Number(t)))return d(),r(Number(t));if(t[0]=='"'&&t[t.length-1]=='"')return t=t.replace(/\"/gm,""),d(),r(t);if(h(t)){if(t=="true")t=!0;if(t=="false")t=!1;return d(),r(t)}if(t=="*")return t=void 0,d(),r(t);return K("Failed to parse value "+t)}function p(){let t=j();if(t.type=="error")return t;if(typeof t.value!="number"&&t.value!==void 0)t.value=Number(t.value);let o=y(":");if(o.type=="error")return o;let n=j();if(n.type=="error")return n;if(typeof n.value!="number"&&n.value!==void 0)n.value=Number(n.value);return r({type:"range",min:t.value,max:n.value})}function W(t){let o=$(t);if(o.errors.length>0)throw o.errors;let n=o.parsed.filter((f)=>!f.pp),l=o.parsed.filter((f)=>f.pp);return{stages:[n,l]}}var A={x:"l0ckbox",j:"l0ckjaw",q:"l0cket",a:"acct_nt",m:"magnara",W:"l0g_wr1t3r",o:"sn_w_usac",f:"shfflr",N:"CON_TELL",n:"CON_SPEC",D:"DATA_CHECK",g:"sn_w_glock","2":"ez_21","3":"ez_35","4":"ez_40",X:"c001",y:"c002",Y:"c003",C:"cron_bot",c:"char_count",s:"script_slot",S:"public_script","0":"channel_count",k:"k3y",b:"balance",w:"log_writer",t:"transactions",T:"transfer",u:"expose_upgrades",U:"transfer_upgrade",l:"expose_access_log",L:"expose_upgrade_log",z:"w4rn",Z:"w4rn_message",r:"w4rn_er"},s,q;function Z(t,o){s={};for(let l in A)s[l]=A[l];let n=!1;for(let l of o.stages){q=[...t];for(let f of l){if(f.return){if(q=q.filter((g)=>!g._filtered),q.length==0)break;continue}if(f.alias){s[f.alias.k]=f.alias.v;continue}let i=[];for(let g of q)if(f.filters&&nt(g,f.filters))i.push(g),n=!0;let m=(f.filters||[]).find((g)=>g._best),_=(f.filters||[]).find((g)=>g._worst);if(m&&typeof m._best=="number")i=Y(i,m._best,!1,m.negative===!0);else if(_&&typeof _._worst=="number")i=Y(i,_._worst,!0,_.negative===!0);for(let g of i)if(g._filtered=!0,f.actions)ot(g,f.actions)}}}function z(t){return t.replace(/\_v\d$/gm,"").replace(/\_V\d$/gm,"")}function P(t){let o=z(t.name),n={k3y:t.k3y,CON_SPEC:t.p2_len,acct_nt:t.acct_nt_min,sn_w_glock:t.expire_secs,sn_w_usac:t.salt_digits,magnara:t.magnara_len,shfflr:t.digits,l0g_wr1t3r:t.loc_count,w4rn_message:t.cooldown,DATA_CHECK:t.acc_mod,l0cket:t.count,l0ckbox:t.count,l0ckjaw:t.count,balance:t.cooldown,expose_access_log:t.count,expose_upgrade_log:t.count,expose_upgrades:t.cooldown,log_writer:t.cooldown,transactions:t.count,transfer_upgrade:t.count,transfer:t.amount,channel_count:t.count,char_count:t.chars,public_script:t.slots,script_slot:t.slots,cron_bot:t.cooldown};if(o in n)return n[o];return 0}function F(t){let o=z(t.name);if(o=="k3y"){if(t.rarity==0)return 3;if(t.rarity==1)return 2;if(t.rarity>=2)return 1}let n={CON_SPEC:t.p2_len,acct_nt:t.acct_nt_min,sn_w_usac:t.salt_digits,magnara:t.magnara_len,shfflr:t.digits,l0g_wr1t3r:t.loc_count,DATA_CHECK:t.acc_mod,l0cket:t.count,l0ckbox:t.count,l0ckjaw:t.count,expose_access_log:t.count,expose_upgrade_log:t.count,transactions:t.count,transfer_upgrade:t.count,transfer:t.amount,channel_count:t.count,char_count:t.chars,public_script:t.slots,script_slot:t.slots,sn_w_glock:-t.expire_secs,w4rn_message:-t.cooldown,balance:-t.cooldown,expose_upgrades:-t.cooldown,log_writer:-t.cooldown,cron_bot:-t.cooldown};if(o in n)return n[o];return 1}function v(t){if(!t.last_time||!t.cooldown)return-1;return t.cooldown*1000-(Date.now()-t.last_time)}function tt(t){return v(t)<=0}function X(t,o){if(o===void 0)return!0;else if(typeof o=="number"||typeof o=="boolean")return t===o;else if(o=="undefined")return t===void 0;else if(typeof o=="string")return t===o;else if(o.type=="range")if(typeof t=="number"){let n=!0;if(t==null)return!1;if(o.min!=null&&t<o.min)n=!1;if(o.max!=null&&t>o.max)n=!1;return n}else return!1;return!1}function nt(t,o){for(let n of o){let f=function(m,_){},l=n.negative==!0,i=n.value;if(n.type=="sun"&&n.alias!=null){if(s[n.alias]!==z(t.name)!==l)return!1;if(n.ready!=null&&n.ready!=tt(t)!==l)return!1;if(n.value!=null&&!X(P(t),n.value)!==l)return!1}for(let m in n){if(["_best","_worst","alias","ready","value","pp","type"].includes(m))continue;let _=n[m];if(_!=null&&!X(t[m],_)!==l)return!1}}return!0}function G(t,o){let n=z(t.name),l=z(o.name),f=F(t),i=F(o);if(n!=l)return 0;if(n=="k3y"&&t.k3y!=o.k3y)return 0;return i-f}function Y(t,o,n,l){if(t.sort(G),n)t.reverse();if(!l)return t.slice(0,o);if(l)return t.slice(o);return[]}function ot(t,o){for(let n of o)if(t[n.k]=n.v,n.v=="undefined")delete t[n.k]}function J(t){return t.sort((o,n)=>{if(o.name!=n.name)return o.name.localeCompare(n.name);let l=G(o,n);if(l!=0)return l;if(o.tier!=n.tier)return n.tier-o.tier;if(o.rarity!=n.rarity)return n.rarity-o.rarity;if(o.loaded!=n.loaded)return n.loaded?1:0;return 0})}function et(t){if(t&&t.import===!0)return{compile:W,filter:Z,sortUpgrades:J,getUpgradeValue:P,getUpgradeQuality:F,Aliases:A};return(`    'J╔══════════════════════════════════════════════════════════════╗'    
    'J║'  cake.sun - Short Upgrade Notation                           'J║'   
    'J╠══════════════════════════════════════════════════════════════╣'    
    'J║'                                                              'J║'   
    'J║'  'I\\ | /                -= SUNSCRIPT =-'                        'J║'
    'J║'  'I- O -        A smart filter for your upgrades'               'J║'
    'J║'  'I/ | \\                 Keep it light'                         'J║'
    'J║'                                                              'J║'   
    'J║'  'IAll info is at https:`+"\/\/"+`github.com/CakeEaterGames/sunscript'  'J║'
    'J║                                                              ║'    
    'J╚══════════════════════════════════════════════════════════════╝'    `).replace(/'/gm,"`")}__main__=et;})();

  return __main__(args);
}