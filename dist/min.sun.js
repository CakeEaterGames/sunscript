function(context,args){ // 
  var __main__;
(()=>{function Q(_){if(_===void 0)return!1;for(let G=0;G<_.length;G++){let z=_[G].charCodeAt(0);if(!(z>=48&&z<=57||z>=65&&z<=90||z>=97&&z<=122||"_".includes(_[G])))return!1}return!0}function b(_){let G=[],z=_.split(`
`);for(let J of z){let P=J,K="\/\/";if(J.includes(K))J=J.substring(0,J.indexOf(K));let D=J.split(";");for(let Z of D){if(Z=Z.trim(),!Z)continue;let W=i(Z);G.push({raw:P,tokens:W})}}return G}function i(_){let z=["->","---",..."=!:;+-^~>[]*"];function J(Z,W,j){return Z.substring(j,j+W.length)==W}let P=" \t\r",K=[],D="";_:for(let Z=0;Z<_.length;Z++){let W=_[Z];if(P.includes(W)){while(P.includes(W)){Z++,W=_[Z];continue}K.push(" ")}for(let O of z)if(J(_,O,Z)){K.push(O),Z+=O.length-1;continue _}if(W=='"'){let O=W;do Z++,W=_[Z],O+=W;while(W!='"');K.push(O);continue}let j=W;Z++,W=_[Z];while(Q(W))j+=W,Z++,W=_[Z];Z--,K.push(j)}if(K.length>0&&K[K.length-1]!=";")K.push(";");return K}function C(_,G,z="",J=""){return E(`${z}Expected any of ["${_.join('", "')}"]. But recieved: "${G}". ${J}`)}var R=[],H=R[0],h=0;function m(_){let G=b(_),z=[],J=[];for(let P of G){R=P.tokens,H=R[0],h=0;let K=p();if(K.type=="error")J.push({line:P.raw,error:K.error});else z.push(...K.value)}return{errors:J,parsed:z}}function M(_){}function X(){if(h++,H=R[h],H===void 0)H=";";return M("Advanced: "+H),H}function n(_){return R[h+_]}function A(){return h>=R.length}function l(){return{curI:h,cur:H}}function t(_){h=_.curI,H=_.cur}function F(_){if(M("consume "+_),H!=_)return C([_],H);M("consumed");let G=H;return X(),Y(void 0)}function $(){while(H==" ")X()}function Y(_){return{type:"success",value:_}}function E(_){return M(_),{type:"error",error:_}}function p(){M("parseScriptLine"),$();let _=[];while(!A()){while(H==";")X();if(A())return Y(_);let G=c();if(G.type=="error")return G;if(G.value)_.push(G.value)}return Y(_)}function c(){M("parseCMD"),$();let _={};if(H==">"){_.type="return",X(),$();let J=F(";");if(J.type=="error")return J;return Y(_)}if(H=="---"){_.type="stage",X(),$();let J=F(";");if(J.type=="error")return J;return Y(_)}if(H=="alias"){_.type="alias";let J=u();if(J.type=="error")return J;return _.data=J.value,Y(_)}let G={};_.type="rule",_.data=G;let z=a();if(z.type=="error")return z;if(G.filters=z.value,$(),H==";")return X(),Y(_);if($(),H=="->"){X();let J=s();if(J.type=="error")return J;G.actions=J.value,$();let P=F(";");if(P.type=="error")return P}if(G.actions&&G.actions.length==0)delete G.actions;if(G.filters&&G.filters.length==0)delete G.filters;return Y(_)}function s(){M("parseActions");let _=[];while(!0){if($(),H==";")return Y(_);let G=r();if(G.type=="error")return G;_.push(G.value)}}function r(){M("parseAction"),$();let _=!1;if(H=="!")_=!0,X(),$();if(!Q(H))return C(["alphanumeric string"],H,"Action error. ");let G=H;if(X(),$(),Q(H)||H==";"){let z=!0;if(_)z="undefined";return Y({k:G,v:z})}else if(H=="="){X(),$();let z=V();if(z.type=="error")return z;let J=z.value;return X(),Y({k:G,v:J})}else return C("=; ".split(""),H)}function u(){M("parseAlias");let _=F("alias");if(_.type=="error")return _;if(_=F(" "),_.type=="error")return _;if($(),H.length!=1)return C(["single alphanumeric character"],H,"Alias error. ");let G=H;if(X(),$(),_=F("="),_.type=="error")return _;if($(),!Q(H))return C(["alphanumeric string"],H,"Alias error. ");let z=H;if(X(),$(),_=F(";"),_.type=="error")return _;return Y({k:G,v:z})}function a(){M("parseFilters"),$();let _=[],G=l(),z=k(),J=e(),P=!1;if(J.type=="error")t(G),P=!0;else{if(z.type=="success"&&z.value===!0)J.value.negative=z.value;_.push(J.value)}$();while(!(H=="->"||H==";"||A())){let K=k(),D=_0();if(D.type=="error"&&J.type=="error"&&P)return E(J.error);if(D.type=="error")return D;if(K.type=="success"&&K.value===!0)D.value.negative=K.value;_.push(D.value),$(),P=!1}return Y(_)}function k(){if($(),H=="!")return X(),Y(!0);else return Y(!1)}function e(){M("parseSUN");let _={filterType:"sun",negative:void 0,loaded:void 0,ready:void 0,alias:void 0,tier:void 0,rarity:void 0,value:void 0};if(H=="+")_.loaded=!0,X();else if(H=="-")_.loaded=!1,X();if(H=="^")_.ready=!0,X();else if(H=="~")_.ready=!1,X();if(!Q(H)&&H!="*")return C(["alias char"],H,"SUN Rule error. ");switch(H.length){case 3:{if(_.alias=H[0],!isNaN(Number(H[1])))_.tier=Number(H[1]);if(!isNaN(Number(H[2])))_.rarity=Number(H[2]);X()}break;case 2:{if(_.alias=H[0],!isNaN(Number(H[1])))_.tier=Number(H[1]);if(X(),H=="*")F("*");else if(H==" ");else if((H+"").length==1&&!isNaN(Number(H)))_.rarity=Number(H),X()}break;case 1:{if(_.alias=H[0],X(),H=="*")F("*");else if(H==" ");else if((H+"").length==1&&!isNaN(Number(H)))_.tier=Number(H),X();else if((H+"").length==2&&!isNaN(Number(H))){_.tier=Number(H[0]),_.rarity=Number(H[1]),X();break}if(H=="*")F("*");else if(H==" ");else if((H+"").length==1&&!isNaN(Number(H)))_.rarity=Number(H),X()}break;default:return C(["alias char"],H,"SUN Rule error. ")}if(_.alias=="*")_.alias=void 0;if(H=="["){F("[");let G=g();if(G.type=="error")return G;if(G.value!="*")_.value=G.value;let z=F("]");if(z.type=="error")return z}if(H!=" "&&H!=";"&&H!="->")return C(["->",";"," "],H,"SUN Rule error. ");if($(),_.loaded===void 0)delete _.loaded;if(_.negative===void 0)delete _.negative;if(_.rarity===void 0)delete _.rarity;if(_.ready===void 0)delete _.ready;if(_.tier===void 0)delete _.tier;if(_.value===void 0)delete _.value;return Y(_)}function _0(){M("parseLUN");let _={filterType:"lun",negative:void 0};if(!Q(H))return C(["alphanumeric string"],H,"LUN Rule error. ");let G=H;X();let z=l();if($(),H=="="){let J=F("=");if(J.type=="error")return J;$();let P=g();if(P.type=="error")return P;return _[G]=P.value,Y(_)}else if([";","->","!"].includes(H)||Q(H))return _[G]=!0,Y(_);else return C(["=",";","->","!"],H,"LUB Rule error. ")}function g(){if(M("parseValue"),n(1)==":"){let _=z0();if(_.type=="error")return _;if(_.value.min==null&&_.value.max==null)return Y(void 0);return _}else{let _=V();if(_.type=="error")return _;if(_.value==null)return Y(void 0);return Y(_.value)}}function V(){M("parseValueType");let _=H;if(!isNaN(Number(_)))return X(),Y(Number(_));if(_[0]=='"'&&_[_.length-1]=='"')return _=_.replace(/\"/gm,""),X(),Y(_);if(Q(_)){if(_=="true")_=!0;if(_=="false")_=!1;return X(),Y(_)}if(_=="*")return _=void 0,X(),Y(_);return E("Failed to parse value "+_)}function z0(){let _=V();if(_.type=="error")return _;if(typeof _.value!="number"&&_.value!==void 0)_.value=Number(_.value);let G=F(":");if(G.type=="error")return G;let z=V();if(z.type=="error")return z;if(typeof z.value!="number"&&z.value!==void 0)z.value=Number(z.value);return Y({type:"range",min:_.value,max:z.value})}function w(_){let G=m(_);if(G.errors.length>0)throw G.errors;let z={stages:[]},J=[];for(let P=0;P<G.parsed.length;P++){let K=G.parsed[P];if(K.type=="stage")z.stages.push(J),J=[];else J.push(K);if(P==G.parsed.length-1)z.stages.push(J)}return z}var N={x:"l0ckbox",j:"l0ckjaw",q:"l0cket",a:"acct_nt",m:"magnara",W:"l0g_wr1t3r",o:"sn_w_usac",f:"shfflr",N:"CON_TELL",n:"CON_SPEC",D:"DATA_CHECK",g:"sn_w_glock","2":"ez_21","3":"ez_35","4":"ez_40",X:"c001",y:"c002",Y:"c003",C:"cron_bot",c:"char_count",s:"script_slot",S:"public_script","0":"channel_count",k:"k3y",b:"balance",w:"log_writer",t:"transactions",T:"transfer",u:"expose_upgrades",U:"transfer_upgrade",l:"expose_access_log",L:"expose_upgrade_log",z:"w4rn",Z:"w4rn_message",r:"w4rn_er"},y,I;function v(_,G){return T(_,w(G))}function T(_,G){y={};for(let K in N)y[K]=N[K];S(_);for(let K=0;K<_.length;K++)_[K]._rank=K;let z=[],J=[];for(let K of G.stages){let D=Date.now(),Z=D;I=[..._];for(let W of I)delete W._filtered;for(let W of K){if(W.type=="return"){if(I=I.filter((j)=>!j._filtered),I.length==0)break;continue}if(W.type=="alias"){y[W.data.k]=W.data.v;continue}if(W.type="rule"){if(!W.data)throw Error("Wtf?");let j=[];for(let B of I){if(!W.data.filters){j.push(B);continue}if(K0(B,W.data.filters))j.push(B)}let O=(W.data.filters||[]).find((B)=>B._best!==void 0),q=(W.data.filters||[]).find((B)=>B._worst!==void 0);if(O&&typeof O._best=="number")j=d(j,O._best,!1,O.negative===!0);else if(q&&typeof q._worst=="number")j=d(j,q._worst,!0,q.negative===!0);for(let B of j){if(!z.includes(B))z.push(B);if(B._filtered=!0,W.data.actions)W0(B,W.data.actions)}}}Z=Date.now(),J.push(Z-D)}for(let K of _)delete K._filtered;let P=0;for(let K of J)P+=K;return{filtered:z,filterTimes:J,filterTime:P}}var L={};function U(_){if(_ in L)return L[_];let G=_.replace(/\_v\d$/gm,"").replace(/\_V\d$/gm,"");return L[_]=G,G}function f(_){if(!_.name)return 0;let G=U(_.name),z={k3y:_.k3y,CON_SPEC:_.p2_len,acct_nt:_.acct_nt_min,sn_w_glock:_.expire_secs,sn_w_usac:_.salt_digits,magnara:_.magnara_len,shfflr:_.digits,l0g_wr1t3r:_.loc_count,w4rn_message:_.cooldown,DATA_CHECK:_.acc_mod,l0cket:_.count,l0ckbox:_.count,l0ckjaw:_.count,balance:_.cooldown,expose_access_log:_.count,expose_upgrade_log:_.count,expose_upgrades:_.cooldown,log_writer:_.cooldown,transactions:_.count,transfer_upgrade:_.count,transfer:_.amount,channel_count:_.count,char_count:_.chars,public_script:_.slots,script_slot:_.slots,cron_bot:_.cooldown};if(G in z)return z[G];return 0}function x(_){if(!_.name)return 0;let G=U(_.name);if(G=="k3y"){if(!_.rarity)return 0;if(_.rarity==0)return 3;if(_.rarity==1)return 2;if(_.rarity>=2)return 1}let z={CON_SPEC:_.p2_len,acct_nt:_.acct_nt_min,sn_w_usac:_.salt_digits,magnara:_.magnara_len,shfflr:_.digits,l0g_wr1t3r:_.loc_count,DATA_CHECK:_.acc_mod,l0cket:_.count,l0ckbox:_.count,l0ckjaw:_.count,expose_access_log:_.count,expose_upgrade_log:_.count,transactions:_.count,transfer_upgrade:_.count,transfer:_.amount,channel_count:_.count,char_count:_.chars,public_script:_.slots,script_slot:_.slots,sn_w_glock:-_.expire_secs,w4rn_message:-_.cooldown,balance:-_.cooldown,expose_upgrades:-_.cooldown,log_writer:-_.cooldown,cron_bot:-_.cooldown};if(G in z)return z[G];return 1}function G0(_){if(!_.last_time||!_.cooldown)return-1;return _.cooldown*1000-(Date.now()-_.last_time)}function H0(_){return G0(_)<=0}function o(_,G){if(G===void 0)return!0;else if(typeof G=="number"||typeof G=="boolean")return _===G;else if(G=="undefined")return _===void 0;else if(typeof G=="string")return _===G;else if(G.type=="range")if(typeof _=="number"){let z=!0;if(_==null)return!1;if(G.min!=null&&_<G.min)z=!1;if(G.max!=null&&_>G.max)z=!1;return z}else return!1;return!1}function J0(_,G){if(!_._short)return!1;return y[G]==_._short}function K0(_,G){for(let z of G){let J=z.negative==!0;if(z.filterType=="sun"){if(z.alias&&!J0(_,z.alias)!==J)return!1;if(z.ready!=null&&z.ready!=H0(_)!==J)return!1;if(z.value!=null&&!o(_._value,z.value)!==J)return!1}for(let P in z){if(["_best","_worst","alias","ready","value","next_stage","filterType"].includes(P))continue;let K=z[P];if(K!=null&&!o(_[P],K)!==J)return!1}}return!0}function P0(_,G){if(!_.name)return 0;if(!G.name)return 0;if(_._short!=G._short)return 0;let z=_._quality,J=G._quality;if(z!==void 0&&J!==void 0&&J!=z)return J-z;return 0}function d(_,G,z,J){if(z&&J)return _.slice(0,_.length-G);else if(z&&!J)return _.slice(_.length-G);else if(!z&&J)return _.slice(G);else if(!z&&!J)return _.slice(0,G);return[]}function W0(_,G){for(let z of G)if(_[z.k]=z.v,z.v=="undefined")delete _[z.k]}function S(_){for(let z of _){if(z.name)z._short=U(z.name);if(!z._priority)z._priority=0;z._value=f(z),z._quality=x(z)}function G(z,J){if(z._short!==void 0&&J._short!==void 0&&z._short!=J._short)return z._short.localeCompare(J._short);let P=P0(z,J);if(P!=0)return P;if(z.tier!==void 0&&J.tier!==void 0&&z.tier!=J.tier)return J.tier-z.tier;if(z.rarity!==void 0&&J.rarity!==void 0&&z.rarity!=J.rarity)return J.rarity-z.rarity;if(z.loaded!==void 0&&J.loaded!==void 0&&z.loaded!=J.loaded)return J.loaded?1:-1;if(z.price!==void 0&&J.price!==void 0&&z.price!=J.price)return z.price-J.price;if(z._priority!=J._priority)return J._priority-z._priority;if(z.sn!==void 0&&J.sn!==void 0&&z.sn!==J.sn)return z.sn.localeCompare(J.sn);return 0}return _.sort(G)}function X0(_){if(_&&_.import===!0)return{compile:w,filter:T,compileAndFilter:v,sortUpgrades:S,getUpgradeValue:f,getUpgradeQuality:x,Aliases:N};return(`    'J╔══════════════════════════════════════════════════════════════╗'    
    'J║'  cake.sun - Short Upgrade Notation                           'J║'   
    'J╠══════════════════════════════════════════════════════════════╣'    
    'J║'                                                              'J║'   
    'J║'  'I\\ | /                -= SUNSCRIPT =-'                        'J║'
    'J║'  'I- O -        A smart filter for your upgrades'               'J║'
    'J║'  'I/ | \\                 Keep it light'                         'J║'
    'J║'                                                              'J║'   
    'J║'  'IAll info is at https:`+"\/\/"+`github.com/CakeEaterGames/sunscript'  'J║'
    'J║                                                              ║'    
    'J╚══════════════════════════════════════════════════════════════╝'    `).replace(/'/gm,"`")}__main__=X0;})();

  return __main__(args);
}