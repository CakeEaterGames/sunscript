function(context,args){ // 
  var __main__;
(()=>{function x(t){if(t===void 0)return!1;for(let e=0;e<t.length;e++){let n=t[e].charCodeAt(0);if(!(n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122||"_".includes(t[e])))return!1}return!0}function H(t){let e=[],n=t.split(`
`);for(let f of n){let l=f,i="\/\/";if(f.includes(i))f=f.substring(0,f.indexOf(i));let m=f.split(";");for(let _ of m){if(_=_.trim(),!_)continue;let d=G(_);e.push({raw:l,tokens:d})}}return e}function G(t){let n=["->",..."=!:;+-^~>[]*"];function f(_,d,s){return _.substring(s,s+d.length)==d}let l=" \t\r",i=[],m="";t:for(let _=0;_<t.length;_++){let d=t[_];if(l.includes(d)){while(l.includes(d)){_++,d=t[_];continue}i.push(" ")}for(let C of n)if(f(t,C,_)){i.push(C),_+=C.length-1;continue t}if(d=='"'){let C=d;do _++,d=t[_],C+=d;while(d!='"');i.push(C);continue}let s=d;_++,d=t[_];while(x(d))s+=d,_++,d=t[_];_--,i.push(s)}if(i.length>0&&i[i.length-1]!=";")i.push(";");return i}var O=[],o=O[0],U=0;function P(t){let e=H(t),n=[],f=[];for(let l of e){O=l.tokens,o=O[0],U=0;let i=c();if(i.type=="error")f.push({line:l.raw,error:i.error});else n.push(...i.value)}return{errors:f,parsed:n}}function y(t){}function g(){if(U++,o=O[U],o===void 0)o=";";return y("Advanced: "+o),o}function J(t){return O[U+t]}function A(){return U>=O.length}function R(){return{curI:U,cur:o}}function M(t){U=t.curI,o=t.cur}function h(t){if(y("consume "+t),o!=t)return y(`Expected ${t} but got ${o}`),b(`Expected ${t} but got ${o}`);y("consumed");let e=o;return g(),r(void 0)}function w(){while(o==" ")g()}function r(t){return{type:"success",value:t}}function b(t){return y("====Throwing and error"),y(t),{type:"error",error:t}}function c(){y("parseScriptLine"),w();let t=[];while(!A()){while(o==";")g();if(A())return r(t);let e=N();if(e.type=="error")return e;if(e.value)t.push(e.value)}return r(t)}function N(){y("parseRule"),w();let t={};if(o==">"){t.return=!0,g(),w();let n=h(";");if(n.type=="error")return n;return r(t)}if(o=="pp"){g(),t.pp=!0;let n=h(" ");if(n.type=="error")return n;w()}if(o=="alias"){let n=I();if(n.type=="error")return n;return t.alias=n.value,r(t)}let e=L();if(e.type=="error")return e;if(t.filters=e.value,w(),o==";")return g(),r(t);if(w(),o=="->"){g();let n=V();if(n.type=="error")return n;t.actions=n.value,w();let f=h(";");if(f.type=="error")return f}return r(t)}function V(){y("parseActions");let t=[];while(!0){if(w(),o==";")return r(t);let e=a();if(e.type=="error")return e;t.push(e.value)}}function a(){y("parseAction"),w();let t={};if(!x(o))return b("Property names must be alphanumeric. You provided "+o);let e=o;if(g(),w(),x(o)||o==";")return r({k:e,v:!0});else if(o=="="){g(),w();let n=q();if(n.type=="error")return n;let f=n.value;return g(),r({k:e,v:f})}else return b("Expected = or ; or space but got "+o)}function I(){y("parseAlias");let t=h("alias");if(t.type=="error")return t;if(t=h(" "),t.type=="error")return t;if(w(),o.length!=1)return b("Aliases can only be single characters. Can't use "+o);let e=o;if(g(),w(),t=h("="),t.type=="error")return t;if(w(),!x(o))return b("Upgrade names must be alphanumeric. You provided"+o);let n=o;if(g(),w(),t=h(";"),t.type=="error")return t;return r({k:e,v:n})}function L(){y("parseFilters"),w();let t=[],e=R(),n=K(),f=k(),l=!1;if(f.type=="error")M(e),l=!0;else{if(n.type=="success"&&n.value===!0)f.value.negative=n.value;t.push(f.value)}w();while(!(o=="->"||o==";"||A())){let i=K(),m=S();if(m.type=="error"&&f.type=="error"&&l)return b(f.error);if(m.type=="error")return m;if(i.type=="success"&&i.value===!0)m.value.negative=i.value;t.push(m.value),w(),l=!1}return r(t)}function K(){if(w(),o=="!")return g(),r(!0);else return r(!1)}function k(){y("parseSUN");let t={type:"sun",negative:void 0,loaded:void 0,ready:void 0,alias:void 0,tier:void 0,rarity:void 0,value:void 0};if(o=="+")t.loaded=!0,g();else if(o=="-")t.loaded=!1,g();if(o=="^")t.ready=!0,g();else if(o=="~")t.ready=!1,g();if(!x(o)&&o!="*")return b("SUN Rule Error. Expected an alias char, but got "+o);switch(o.length){case 3:{if(t.alias=o[0],!isNaN(Number(o[1])))t.tier=Number(o[1]);if(!isNaN(Number(o[2])))t.rarity=Number(o[2]);g()}break;case 2:{if(t.alias=o[0],!isNaN(Number(o[1])))t.tier=Number(o[1]);if(g(),o!=" "&&(o+"").length==1&&!isNaN(Number(o)))t.rarity=Number(o),g()}break;case 1:{if(t.alias=o[0],g(),o!=" "&&(o+"").length==1&&!isNaN(Number(o)))t.tier=Number(o),g();if(o!=" "&&(o+"").length==1&&!isNaN(Number(o)))t.rarity=Number(o),g()}break;default:return b("SUN Rule Error. Expected an alias char, but got "+o)}if(t.alias=="*")t.alias=void 0;if(o=="["){h("[");let e=$();if(e.type=="error")return e;if(e.value!="*")t.value=e.value;let n=h("]");if(n.type=="error")return n}if(o!=" "&&o!=";"&&o!="->")return b("SUN Rule Error. Expected -> or ; or space but got "+o);if(g(),t.loaded===void 0)delete t.loaded;if(t.negative===void 0)delete t.negative;if(t.rarity===void 0)delete t.rarity;if(t.ready===void 0)delete t.ready;if(t.tier===void 0)delete t.tier;if(t.value===void 0)delete t.value;return r(t)}function S(){y("parseLUN");let t={type:"lun",negative:void 0};if(!x(o))return b("Property name must be alphanumeric. Got "+o);let e=o;g();let n=R();if(w(),o=="="){let f=h("=");if(f.type=="error")return f;w();let l=$();if(l.type=="error")return l;return t[e]=l.value,r(t)}else if([";","->","!"].includes(o)||x(o))return t[e]=!0,r(t);else return b("Failed to parse LUN. Expected = or ; or -> or ! or space. Got "+o)}function $(){if(y("parseValue"),J(1)==":"){let t=p();if(t.type=="error")return t;if(t.value.min==null&&t.value.max==null)return r(void 0);return t}else{let t=q();if(t.type=="error")return t;if(t.value==null)return r(void 0);return r(t.value)}}function q(){y("parseValueType");let t=o;if(!isNaN(Number(t)))return g(),r(Number(t));if(t[0]=='"'&&t[t.length-1]=='"')return t=t.replace(/\"/gm,""),g(),r(t);if(x(t)){if(t=="true")t=!0;if(t=="false")t=!1;return g(),r(t)}if(t=="*")return t=void 0,g(),r(t);return b("Failed to parse value "+t)}function p(){let t=q();if(t.type=="error")return t;if(typeof t.value!="number"&&t.value!==void 0)t.value=Number(t.value);let e=h(":");if(e.type=="error")return e;let n=q();if(n.type=="error")return n;if(typeof n.value!="number"&&n.value!==void 0)n.value=Number(n.value);return r({type:"range",min:t.value,max:n.value})}function B(t){let e=P(t);if(e.errors.length>0)throw e.errors;let n=e.parsed.filter((l)=>!l.pp),f=e.parsed.filter((l)=>l.pp);return{stages:[n,f]}}var E={x:"l0ckbox",j:"l0ckjaw",q:"l0cket",a:"acct_nt",m:"magnara",W:"l0g_wr1t3r",o:"sn_w_usac",f:"shfflr",N:"CON_TELL",n:"CON_SPEC",D:"DATA_CHECK",g:"sn_w_glock","2":"ez_21","3":"ez_35","4":"ez_40",X:"c001",y:"c002",Y:"c003",C:"cron_bot",c:"char_count",s:"script_slot",S:"public_script","0":"channel_count",k:"k3y",b:"balance",w:"log_writer",t:"transactions",T:"transfer",u:"expose_upgrades",U:"transfer_upgrade",l:"expose_access_log",L:"expose_upgrade_log",z:"w4rn",Z:"w4rn_message",r:"w4rn_er"},z,D;function X(t,e){z={};for(let f in E)z[f]=E[f];let n=!1;for(let f of e.stages){D=[...t];for(let l of f){if(l.return){if(D=D.filter((d)=>!d._filtered),D.length==0)break;continue}if(l.alias){z[l.alias.k]=l.alias.v;continue}let i=[];for(let d of D)if(l.filters&&tt(d,l.filters))i.push(d),n=!0;let m=(l.filters||[]).find((d)=>d._best),_=(l.filters||[]).find((d)=>d._worst);if(m&&typeof m._best=="number")i=W(i,m._best,!1,m.negative===!0);else if(_&&typeof _._worst=="number")i=W(i,_._worst,!0,_.negative===!0);for(let d of i)if(d._filtered=!0,l.actions)nt(d,l.actions)}}}function T(t){return t.replace(/\_v\d$/gm,"").replace(/\_V\d$/gm,"")}function F(t){let e=T(t.name),n={k3y:t.k3y,CON_SPEC:t.p2_len,acct_nt:t.acct_nt_min,sn_w_glock:t.expire_secs,sn_w_usac:t.salt_digits,magnara:t.magnara_len,shfflr:t.digits,l0g_wr1t3r:t.loc_count,w4rn_message:t.cooldown,DATA_CHECK:t.acc_mod,l0cket:t.count,l0ckbox:t.count,l0ckjaw:t.count,balance:t.cooldown,expose_access_log:t.count,expose_upgrade_log:t.count,expose_upgrades:t.cooldown,log_writer:t.cooldown,transactions:t.count,transfer_upgrade:t.count,transfer:t.amount,channel_count:t.count,char_count:t.chars,public_script:t.slots,script_slot:t.slots,cron_bot:t.cooldown};if(e in n)return n[e];return 0}function j(t){let e=T(t.name);if(e=="k3y"){if(t.rarity==0)return 3;if(t.rarity==1)return 2;if(t.rarity>=2)return 1}let n={CON_SPEC:t.p2_len,acct_nt:t.acct_nt_min,sn_w_usac:t.salt_digits,magnara:t.magnara_len,shfflr:t.digits,l0g_wr1t3r:t.loc_count,DATA_CHECK:t.acc_mod,l0cket:t.count,l0ckbox:t.count,l0ckjaw:t.count,expose_access_log:t.count,expose_upgrade_log:t.count,transactions:t.count,transfer_upgrade:t.count,transfer:t.amount,channel_count:t.count,char_count:t.chars,public_script:t.slots,script_slot:t.slots,sn_w_glock:-t.expire_secs,w4rn_message:-t.cooldown,balance:-t.cooldown,expose_upgrades:-t.cooldown,log_writer:-t.cooldown,cron_bot:-t.cooldown};if(e in n)return n[e];return 1}function u(t){if(!t.last_time||!t.cooldown)return-1;return t.cooldown*1000-(Date.now()-t.last_time)}function v(t){return u(t)<=0}function Q(t,e){if(e===void 0)return!0;else if(typeof e=="number"||typeof e=="boolean")return t===e;else if(e=="undefined")return t===void 0;else if(typeof e=="string")return t===e;else if(e.type=="range")if(typeof t=="number"){let n=!0;if(t==null)return!1;if(e.min!=null&&t<e.min)n=!1;if(e.max!=null&&t>e.max)n=!1;return n}else return!1;return!1}function tt(t,e){for(let n of e){let l=function(m,_){},f=n.negative==!0,i=n.value;if(n.type=="sun"&&n.alias!=null){if(z[n.alias]!==T(t.name)!==f)return!1;if(n.ready!=null&&n.ready!=v(t)!==f)return!1;if(n.value!=null&&!Q(F(t),n.value)!==f)return!1}for(let m in n){if(["_best","_worst","alias","ready","value","pp","type"].includes(m))continue;let _=n[m];if(_!=null&&!Q(t[m],_)!==f)return!1}}return!0}function Y(t,e){let n=T(t.name),f=T(e.name),l=j(t),i=j(e);if(n!=f)return 0;if(n=="k3y"&&t.k3y!=e.k3y)return 0;return i-l}function W(t,e,n,f){if(t.sort(Y),n)t.reverse();if(!f)return t.slice(0,e);if(f)return t.slice(e);return[]}function nt(t,e){for(let n of e)if(t[n.k]=n.v,n.v=="undefined")delete t[n.k]}function Z(t){return t.sort((e,n)=>{if(e.name!=n.name)return e.name.localeCompare(n.name);let f=Y(e,n);if(f!=0)return f;if(e.tier!=n.tier)return n.tier-e.tier;if(e.rarity!=n.rarity)return n.rarity-e.rarity;if(e.loaded!=n.loaded)return n.loaded?1:0;return 0})}function et(t){if(t&&t.import===!0)return{compile:B,filter:X,sortUpgrades:Z,getUpgradeValue:F,getUpgradeQuality:j,Aliases:E};return(`    'J╔══════════════════════════════════════════════════════════════╗'    
    'J║'  cake.sun - Short Upgrade Notation                           'J║'   
    'J╠══════════════════════════════════════════════════════════════╣'    
    'J║'                                                              'J║'   
    'J║'  'I\\ | /                -= SUNSCRIPT =-'                        'J║'
    'J║'  'I- O -        A smart filter for your upgrades'               'J║'
    'J║'  'I/ | \\                 Keep it light'                         'J║'
    'J║'                                                              'J║'   
    'J║'  'IAll info is at https:`+"\/\/"+`github.com/CakeEaterGames/sunscript'  'J║'
    'J║                                                              ║'    
    'J╚══════════════════════════════════════════════════════════════╝'    `).replace(/'/gm,"`")}__main__=et;})();

  return __main__(args);
}