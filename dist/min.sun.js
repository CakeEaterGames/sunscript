function(context,args){ // 
  var __main__;
(()=>{function Q(_){if(_===void 0)return!1;for(let z=0;z<_.length;z++){let G=_[z].charCodeAt(0);if(!(G>=48&&G<=57||G>=65&&G<=90||G>=97&&G<=122||"_".includes(_[z])))return!1}return!0}function b(_){let z=[],G=_.split(`
`);for(let J of G){let P=J,K="\/\/";if(J.includes(K))J=J.substring(0,J.indexOf(K));let D=J.split(";");for(let Z of D){if(Z=Z.trim(),!Z)continue;let W=i(Z);z.push({raw:P,tokens:W})}}return z}function i(_){let G=["->","---",..."=!:;+-^~>[]*"];function J(Z,W,j){return Z.substring(j,j+W.length)==W}let P=" 	\r",K=[],D="";_:for(let Z=0;Z<_.length;Z++){let W=_[Z];if(P.includes(W)){while(P.includes(W)){Z++,W=_[Z];continue}K.push(" ")}for(let O of G)if(J(_,O,Z)){K.push(O),Z+=O.length-1;continue _}if(W=='"'){let O=W;do Z++,W=_[Z],O+=W;while(W!='"');K.push(O);continue}let j=W;Z++,W=_[Z];while(Q(W))j+=W,Z++,W=_[Z];Z--,K.push(j)}if(K.length>0&&K[K.length-1]!=";")K.push(";");return K}function C(_,z,G="",J=""){return E(`${G}Expected any of ["${_.join('", "')}"]. But recieved: "${z}". ${J}`)}var R=[],H=R[0],h=0;function m(_){let z=b(_),G=[],J=[];for(let P of z){R=P.tokens,H=R[0],h=0;let K=p();if(K.type=="error")J.push({line:P.raw,error:K.error});else G.push(...K.value)}return{errors:J,parsed:G}}function M(_){}function X(){if(h++,H=R[h],H===void 0)H=";";return M("Advanced: "+H),H}function n(_){return R[h+_]}function A(){return h>=R.length}function l(){return{curI:h,cur:H}}function t(_){h=_.curI,H=_.cur}function F(_){if(M("consume "+_),H!=_)return C([_],H);M("consumed");let z=H;return X(),Y(void 0)}function $(){while(H==" ")X()}function Y(_){return{type:"success",value:_}}function E(_){return M(_),{type:"error",error:_}}function p(){M("parseScriptLine"),$();let _=[];while(!A()){while(H==";")X();if(A())return Y(_);let z=c();if(z.type=="error")return z;if(z.value)_.push(z.value)}return Y(_)}function c(){M("parseCMD"),$();let _={};if(H==">"){_.type="return",X(),$();let J=F(";");if(J.type=="error")return J;return Y(_)}if(H=="---"){_.type="stage",X(),$();let J=F(";");if(J.type=="error")return J;return Y(_)}if(H=="alias"){_.type="alias";let J=u();if(J.type=="error")return J;return _.data=J.value,Y(_)}let z={};_.type="rule",_.data=z;let G=a();if(G.type=="error")return G;if(z.filters=G.value,$(),H==";")return X(),Y(_);if($(),H=="->"){X();let J=s();if(J.type=="error")return J;z.actions=J.value,$();let P=F(";");if(P.type=="error")return P}if(z.actions&&z.actions.length==0)delete z.actions;if(z.filters&&z.filters.length==0)delete z.filters;return Y(_)}function s(){M("parseActions");let _=[];while(!0){if($(),H==";")return Y(_);let z=r();if(z.type=="error")return z;_.push(z.value)}}function r(){M("parseAction"),$();let _=!1;if(H=="!")_=!0,X(),$();if(!Q(H))return C(["alphanumeric string"],H,"Action error. ");let z=H;if(X(),$(),Q(H)||H==";"){let G=!0;if(_)G="undefined";return Y({k:z,v:G})}else if(H=="="){X(),$();let G=V();if(G.type=="error")return G;let J=G.value;return X(),Y({k:z,v:J})}else return C("=; ".split(""),H)}function u(){M("parseAlias");let _=F("alias");if(_.type=="error")return _;if(_=F(" "),_.type=="error")return _;if($(),H.length!=1)return C(["single alphanumeric character"],H,"Alias error. ");let z=H;if(X(),$(),_=F("="),_.type=="error")return _;if($(),!Q(H))return C(["alphanumeric string"],H,"Alias error. ");let G=H;if(X(),$(),_=F(";"),_.type=="error")return _;return Y({k:z,v:G})}function a(){M("parseFilters"),$();let _=[],z=l(),G=k(),J=e(),P=!1;if(J.type=="error")t(z),P=!0;else{if(G.type=="success"&&G.value===!0)J.value.negative=G.value;_.push(J.value)}$();while(!(H=="->"||H==";"||A())){let K=k(),D=_0();if(D.type=="error"&&J.type=="error"&&P)return E(J.error);if(D.type=="error")return D;if(K.type=="success"&&K.value===!0)D.value.negative=K.value;_.push(D.value),$(),P=!1}return Y(_)}function k(){if($(),H=="!")return X(),Y(!0);else return Y(!1)}function e(){M("parseSUN");let _={filterType:"sun",negative:void 0,loaded:void 0,ready:void 0,alias:void 0,tier:void 0,rarity:void 0,value:void 0};if(H=="+")_.loaded=!0,X();else if(H=="-")_.loaded=!1,X();if(H=="^")_.ready=!0,X();else if(H=="~")_.ready=!1,X();if(!Q(H)&&H!="*")return C(["alias char"],H,"SUN Rule error. ");switch(H.length){case 3:{if(_.alias=H[0],!isNaN(Number(H[1])))_.tier=Number(H[1]);if(!isNaN(Number(H[2])))_.rarity=Number(H[2]);X()}break;case 2:{if(_.alias=H[0],!isNaN(Number(H[1])))_.tier=Number(H[1]);if(X(),H=="*")F("*");else if(H==" ");else if((H+"").length==1&&!isNaN(Number(H)))_.rarity=Number(H),X()}break;case 1:{if(_.alias=H[0],X(),H=="*")F("*");else if(H==" ");else if((H+"").length==1&&!isNaN(Number(H)))_.tier=Number(H),X();if(H=="*")F("*");else if(H==" ");else if((H+"").length==1&&!isNaN(Number(H)))_.rarity=Number(H),X()}break;default:return C(["alias char"],H,"SUN Rule error. ")}if(_.alias=="*")_.alias=void 0;if(H=="["){F("[");let z=g();if(z.type=="error")return z;if(z.value!="*")_.value=z.value;let G=F("]");if(G.type=="error")return G}if(H!=" "&&H!=";"&&H!="->")return C(["->",";"," "],H,"SUN Rule error. ");if($(),_.loaded===void 0)delete _.loaded;if(_.negative===void 0)delete _.negative;if(_.rarity===void 0)delete _.rarity;if(_.ready===void 0)delete _.ready;if(_.tier===void 0)delete _.tier;if(_.value===void 0)delete _.value;return Y(_)}function _0(){M("parseLUN");let _={filterType:"lun",negative:void 0};if(!Q(H))return C(["alphanumeric string"],H,"LUN Rule error. ");let z=H;X();let G=l();if($(),H=="="){let J=F("=");if(J.type=="error")return J;$();let P=g();if(P.type=="error")return P;return _[z]=P.value,Y(_)}else if([";","->","!"].includes(H)||Q(H))return _[z]=!0,Y(_);else return C(["=",";","->","!"],H,"LUB Rule error. ")}function g(){if(M("parseValue"),n(1)==":"){let _=z0();if(_.type=="error")return _;if(_.value.min==null&&_.value.max==null)return Y(void 0);return _}else{let _=V();if(_.type=="error")return _;if(_.value==null)return Y(void 0);return Y(_.value)}}function V(){M("parseValueType");let _=H;if(!isNaN(Number(_)))return X(),Y(Number(_));if(_[0]=='"'&&_[_.length-1]=='"')return _=_.replace(/\"/gm,""),X(),Y(_);if(Q(_)){if(_=="true")_=!0;if(_=="false")_=!1;return X(),Y(_)}if(_=="*")return _=void 0,X(),Y(_);return E("Failed to parse value "+_)}function z0(){let _=V();if(_.type=="error")return _;if(typeof _.value!="number"&&_.value!==void 0)_.value=Number(_.value);let z=F(":");if(z.type=="error")return z;let G=V();if(G.type=="error")return G;if(typeof G.value!="number"&&G.value!==void 0)G.value=Number(G.value);return Y({type:"range",min:_.value,max:G.value})}function w(_){let z=m(_);if(z.errors.length>0)throw z.errors;let G={stages:[]},J=[];for(let P=0;P<z.parsed.length;P++){let K=z.parsed[P];if(K.type=="stage")G.stages.push(J),J=[];else J.push(K);if(P==z.parsed.length-1)G.stages.push(J)}return G}var N={x:"l0ckbox",j:"l0ckjaw",q:"l0cket",a:"acct_nt",m:"magnara",W:"l0g_wr1t3r",o:"sn_w_usac",f:"shfflr",N:"CON_TELL",n:"CON_SPEC",D:"DATA_CHECK",g:"sn_w_glock","2":"ez_21","3":"ez_35","4":"ez_40",X:"c001",y:"c002",Y:"c003",C:"cron_bot",c:"char_count",s:"script_slot",S:"public_script","0":"channel_count",k:"k3y",b:"balance",w:"log_writer",t:"transactions",T:"transfer",u:"expose_upgrades",U:"transfer_upgrade",l:"expose_access_log",L:"expose_upgrade_log",z:"w4rn",Z:"w4rn_message",r:"w4rn_er"},y,I;function v(_,z){return T(_,w(z))}function T(_,z){y={};for(let K in N)y[K]=N[K];for(let K of _){if(K.name)K._short=U(K.name);K._value=f(K),K._quality=x(K)}S(_);for(let K=0;K<_.length;K++)_[K]._rank=K;let G=[],J=[];for(let K of z.stages){let D=Date.now(),Z=D;I=[..._];for(let W of I)delete W._filtered;for(let W of K){if(W.type=="return"){if(I=I.filter((j)=>!j._filtered),I.length==0)break;continue}if(W.type=="alias"){y[W.data.k]=W.data.v;continue}if(W.type="rule"){if(!W.data)throw Error("Wtf?");let j=[];for(let B of I){if(!W.data.filters){j.push(B);continue}if(K0(B,W.data.filters))j.push(B)}let O=(W.data.filters||[]).find((B)=>B._best!==void 0),q=(W.data.filters||[]).find((B)=>B._worst!==void 0);if(O&&typeof O._best=="number")j=d(j,O._best,!1,O.negative===!0);else if(q&&typeof q._worst=="number")j=d(j,q._worst,!0,q.negative===!0);for(let B of j){if(!G.includes(B))G.push(B);if(B._filtered=!0,W.data.actions)W0(B,W.data.actions)}}}Z=Date.now(),J.push(Z-D)}for(let K of _)delete K._filtered;let P=0;for(let K of J)P+=K;return{filtered:G,filterTimes:J,filterTime:P}}var L={};function U(_){if(_ in L)return L[_];let z=_.replace(/\_v\d$/gm,"").replace(/\_V\d$/gm,"");return L[_]=z,z}function f(_){if(!_.name)return 0;let z=U(_.name),G={k3y:_.k3y,CON_SPEC:_.p2_len,acct_nt:_.acct_nt_min,sn_w_glock:_.expire_secs,sn_w_usac:_.salt_digits,magnara:_.magnara_len,shfflr:_.digits,l0g_wr1t3r:_.loc_count,w4rn_message:_.cooldown,DATA_CHECK:_.acc_mod,l0cket:_.count,l0ckbox:_.count,l0ckjaw:_.count,balance:_.cooldown,expose_access_log:_.count,expose_upgrade_log:_.count,expose_upgrades:_.cooldown,log_writer:_.cooldown,transactions:_.count,transfer_upgrade:_.count,transfer:_.amount,channel_count:_.count,char_count:_.chars,public_script:_.slots,script_slot:_.slots,cron_bot:_.cooldown};if(z in G)return G[z];return 0}function x(_){if(!_.name)return 0;let z=U(_.name);if(z=="k3y"){if(!_.rarity)return 0;if(_.rarity==0)return 3;if(_.rarity==1)return 2;if(_.rarity>=2)return 1}let G={CON_SPEC:_.p2_len,acct_nt:_.acct_nt_min,sn_w_usac:_.salt_digits,magnara:_.magnara_len,shfflr:_.digits,l0g_wr1t3r:_.loc_count,DATA_CHECK:_.acc_mod,l0cket:_.count,l0ckbox:_.count,l0ckjaw:_.count,expose_access_log:_.count,expose_upgrade_log:_.count,transactions:_.count,transfer_upgrade:_.count,transfer:_.amount,channel_count:_.count,char_count:_.chars,public_script:_.slots,script_slot:_.slots,sn_w_glock:-_.expire_secs,w4rn_message:-_.cooldown,balance:-_.cooldown,expose_upgrades:-_.cooldown,log_writer:-_.cooldown,cron_bot:-_.cooldown};if(z in G)return G[z];return 1}function G0(_){if(!_.last_time||!_.cooldown)return-1;return _.cooldown*1000-(Date.now()-_.last_time)}function H0(_){return G0(_)<=0}function o(_,z){if(z===void 0)return!0;else if(typeof z=="number"||typeof z=="boolean")return _===z;else if(z=="undefined")return _===void 0;else if(typeof z=="string")return _===z;else if(z.type=="range")if(typeof _=="number"){let G=!0;if(_==null)return!1;if(z.min!=null&&_<z.min)G=!1;if(z.max!=null&&_>z.max)G=!1;return G}else return!1;return!1}function J0(_,z){if(!_._short)return!1;return y[z]==_._short}function K0(_,z){for(let G of z){let J=G.negative==!0;if(G.filterType=="sun"){if(G.alias&&!J0(_,G.alias)!==J)return!1;if(G.ready!=null&&G.ready!=H0(_)!==J)return!1;if(G.value!=null&&!o(_._value,G.value)!==J)return!1}for(let P in G){if(["_best","_worst","alias","ready","value","next_stage","filterType"].includes(P))continue;let K=G[P];if(K!=null&&!o(_[P],K)!==J)return!1}}return!0}function P0(_,z){if(!_.name)return 0;if(!z.name)return 0;let G=_._short,J=z._short,P=_._quality,K=z._quality;if(G!=J)return 0;if(G=="k3y"&&_.k3y!=z.k3y)return 0;if(P!==void 0&&K!==void 0&&K!=P)return K-P;if(_.sn&&z.sn)return _.sn.localeCompare(z.sn);return 0}function d(_,z,G,J){if(G&&J)return _.slice(0,_.length-z);else if(G&&!J)return _.slice(_.length-z);else if(!G&&J)return _.slice(z);else if(!G&&!J)return _.slice(0,z);return[]}function W0(_,z){for(let G of z)if(_[G.k]=G.v,G.v=="undefined")delete _[G.k]}function S(_){return _.sort((z,G)=>{if(z.name!==void 0&&G.name!==void 0&&z.name!=G.name)return z.name.localeCompare(G.name);let J=P0(z,G);if(J!=0)return J;if(z.tier!==void 0&&G.tier!==void 0&&z.tier!=G.tier)return G.tier-z.tier;if(z.rarity!==void 0&&G.rarity!==void 0&&z.rarity!=G.rarity)return G.rarity-z.rarity;if(z.loaded!==void 0&&G.loaded!==void 0&&z.loaded!=G.loaded)return G.loaded?1:0;return 0})}function X0(_){if(_&&_.import===!0)return{compile:w,filter:T,compileAndFilter:v,sortUpgrades:S,getUpgradeValue:f,getUpgradeQuality:x,Aliases:N};return(`    'J╔══════════════════════════════════════════════════════════════╗'    
    'J║'  cake.sun - Short Upgrade Notation                           'J║'   
    'J╠══════════════════════════════════════════════════════════════╣'    
    'J║'                                                              'J║'   
    'J║'  'I\\ | /                -= SUNSCRIPT =-'                        'J║'
    'J║'  'I- O -        A smart filter for your upgrades'               'J║'
    'J║'  'I/ | \\                 Keep it light'                         'J║'
    'J║'                                                              'J║'   
    'J║'  'IAll info is at https:`+"\/\/"+`github.com/CakeEaterGames/sunscript'  'J║'
    'J║                                                              ║'    
    'J╚══════════════════════════════════════════════════════════════╝'    `).replace(/'/gm,"`")}__main__=X0;})();

  return __main__(args);
}