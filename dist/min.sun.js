function(context,args){ // 
  var __main__;
(()=>{function C(_){if(_===void 0)return!1;for(let z=0;z<_.length;z++){let G=_[z].charCodeAt(0);if(!(G>=48&&G<=57||G>=65&&G<=90||G>=97&&G<=122||"_".includes(_[z])))return!1}return!0}function b(_){let z=[],G=_.split(`
`);for(let J of G){let W=J,K="\/\/";if(J.includes(K))J=J.substring(0,J.indexOf(K));let O=J.split(";");for(let Z of O){if(Z=Z.trim(),!Z)continue;let P=i(Z);z.push({raw:W,tokens:P})}}return z}function i(_){let G=["->","---",..."=!:;+-^~>[]*"];function J(Z,P,j){return Z.substring(j,j+P.length)==P}let W=" 	\r",K=[],O="";_:for(let Z=0;Z<_.length;Z++){let P=_[Z];if(W.includes(P)){while(W.includes(P)){Z++,P=_[Z];continue}K.push(" ")}for(let Q of G)if(J(_,Q,Z)){K.push(Q),Z+=Q.length-1;continue _}if(P=='"'){let Q=P;do Z++,P=_[Z],Q+=P;while(P!='"');K.push(Q);continue}let j=P;Z++,P=_[Z];while(C(P))j+=P,Z++,P=_[Z];Z--,K.push(j)}if(K.length>0&&K[K.length-1]!=";")K.push(";");return K}function B(_,z,G="",J=""){return L(`${G}Expected any of ["${_.join('", "')}"]. But recieved: "${z}". ${J}`)}var R=[],H=R[0],h=0;function m(_){let z=b(_),G=[],J=[];for(let W of z){R=W.tokens,H=R[0],h=0;let K=p();if(K.type=="error")J.push({line:W.raw,error:K.error});else G.push(...K.value)}return{errors:J,parsed:G}}function M(_){}function X(){if(h++,H=R[h],H===void 0)H=";";return M("Advanced: "+H),H}function n(_){return R[h+_]}function A(){return h>=R.length}function l(){return{curI:h,cur:H}}function t(_){h=_.curI,H=_.cur}function F(_){if(M("consume "+_),H!=_)return B([_],H);M("consumed");let z=H;return X(),Y(void 0)}function $(){while(H==" ")X()}function Y(_){return{type:"success",value:_}}function L(_){return M(_),{type:"error",error:_}}function p(){M("parseScriptLine"),$();let _=[];while(!A()){while(H==";")X();if(A())return Y(_);let z=c();if(z.type=="error")return z;if(z.value)_.push(z.value)}return Y(_)}function c(){M("parseCMD"),$();let _={};if(H==">"){_.type="return",X(),$();let J=F(";");if(J.type=="error")return J;return Y(_)}if(H=="---"){_.type="stage",X(),$();let J=F(";");if(J.type=="error")return J;return Y(_)}if(H=="alias"){_.type="alias";let J=u();if(J.type=="error")return J;return _.data=J.value,Y(_)}let z={};_.type="rule",_.data=z;let G=a();if(G.type=="error")return G;if(z.filters=G.value,$(),H==";")return X(),Y(_);if($(),H=="->"){X();let J=s();if(J.type=="error")return J;z.actions=J.value,$();let W=F(";");if(W.type=="error")return W}if(z.actions&&z.actions.length==0)delete z.actions;if(z.filters&&z.filters.length==0)delete z.filters;return Y(_)}function s(){M("parseActions");let _=[];while(!0){if($(),H==";")return Y(_);let z=r();if(z.type=="error")return z;_.push(z.value)}}function r(){M("parseAction"),$();let _=!1;if(H=="!")_=!0,X(),$();if(!C(H))return B(["alphanumeric string"],H,"Action error. ");let z=H;if(X(),$(),C(H)||H==";"){let G=!0;if(_)G="undefined";return Y({k:z,v:G})}else if(H=="="){X(),$();let G=V();if(G.type=="error")return G;let J=G.value;return X(),Y({k:z,v:J})}else return B("=; ".split(""),H)}function u(){M("parseAlias");let _=F("alias");if(_.type=="error")return _;if(_=F(" "),_.type=="error")return _;if($(),H.length!=1)return B(["single alphanumeric character"],H,"Alias error. ");let z=H;if(X(),$(),_=F("="),_.type=="error")return _;if($(),!C(H))return B(["alphanumeric string"],H,"Alias error. ");let G=H;if(X(),$(),_=F(";"),_.type=="error")return _;return Y({k:z,v:G})}function a(){M("parseFilters"),$();let _=[],z=l(),G=k(),J=e(),W=!1;if(J.type=="error")t(z),W=!0;else{if(G.type=="success"&&G.value===!0)J.value.negative=G.value;_.push(J.value)}$();while(!(H=="->"||H==";"||A())){let K=k(),O=_0();if(O.type=="error"&&J.type=="error"&&W)return L(J.error);if(O.type=="error")return O;if(K.type=="success"&&K.value===!0)O.value.negative=K.value;_.push(O.value),$(),W=!1}return Y(_)}function k(){if($(),H=="!")return X(),Y(!0);else return Y(!1)}function e(){M("parseSUN");let _={filterType:"sun",negative:void 0,loaded:void 0,ready:void 0,alias:void 0,tier:void 0,rarity:void 0,value:void 0};if(H=="+")_.loaded=!0,X();else if(H=="-")_.loaded=!1,X();if(H=="^")_.ready=!0,X();else if(H=="~")_.ready=!1,X();if(!C(H)&&H!="*")return B(["alias char"],H,"SUN Rule error. ");switch(H.length){case 3:{if(_.alias=H[0],isNaN(Number(H[1])))return B(["number"],H[1],"SUN Rule error. ");if(isNaN(Number(H[2])))return B(["number"],H[2],"SUN Rule error. ");_.tier=Number(H[1]),_.rarity=Number(H[2]),X()}break;case 2:{if(_.alias=H[0],isNaN(Number(H[1])))return B(["number"],H[1],"SUN Rule error. ");if(_.tier=Number(H[1]),X(),H=="*")F("*");else if(H==" ");else if((H+"").length==1&&!isNaN(Number(H)))_.rarity=Number(H),X()}break;case 1:{if(_.alias=H[0],X(),H=="*")F("*");else if(H==" ");else if((H+"").length==1&&!isNaN(Number(H)))_.tier=Number(H),X();else if((H+"").length==2&&!isNaN(Number(H))){_.tier=Number(H[0]),_.rarity=Number(H[1]),X();break}if(H=="*")F("*");else if(H==" ");else if((H+"").length==1&&!isNaN(Number(H)))_.rarity=Number(H),X()}break;default:return B(["alias char"],H,"SUN Rule error. ")}if(_.alias=="*")_.alias=void 0;if(H=="["){F("[");let z=g();if(z.type=="error")return z;if(z.value!="*")_.value=z.value;let G=F("]");if(G.type=="error")return G}if(H!=" "&&H!=";"&&H!="->")return B(["->",";"," "],H,"SUN Rule error. ");if($(),_.loaded===void 0)delete _.loaded;if(_.negative===void 0)delete _.negative;if(_.rarity===void 0)delete _.rarity;if(_.ready===void 0)delete _.ready;if(_.tier===void 0)delete _.tier;if(_.value===void 0)delete _.value;return Y(_)}function _0(){M("parseLUN");let _={filterType:"lun",negative:void 0};if(!C(H))return B(["alphanumeric string"],H,"LUN Rule error. ");let z=H;X();let G=l();if($(),H=="="){let J=F("=");if(J.type=="error")return J;$();let W=g();if(W.type=="error")return W;return _[z]=W.value,Y(_)}else if([";","->","!"].includes(H)||C(H))return _[z]=!0,Y(_);else return B(["=",";","->","!"],H,"LUB Rule error. ")}function g(){if(M("parseValue"),n(1)==":"){let _=z0();if(_.type=="error")return _;if(_.value.min==null&&_.value.max==null)return Y(void 0);return _}else{let _=V();if(_.type=="error")return _;if(_.value==null)return Y(void 0);return Y(_.value)}}function V(){M("parseValueType");let _=H;if(!isNaN(Number(_)))return X(),Y(Number(_));if(_[0]=='"'&&_[_.length-1]=='"')return _=_.replace(/\"/gm,""),X(),Y(_);if(C(_)){if(_=="true")_=!0;if(_=="false")_=!1;return X(),Y(_)}if(_=="*")return _=void 0,X(),Y(_);return L("Failed to parse value "+_)}function z0(){let _=V();if(_.type=="error")return _;if(typeof _.value!="number"&&_.value!==void 0)_.value=Number(_.value);let z=F(":");if(z.type=="error")return z;let G=V();if(G.type=="error")return G;if(typeof G.value!="number"&&G.value!==void 0)G.value=Number(G.value);return Y({type:"range",min:_.value,max:G.value})}function w(_){let z=m(_);if(z.errors.length>0)throw z.errors;let G={stages:[]},J=[];for(let W=0;W<z.parsed.length;W++){let K=z.parsed[W];if(K.type=="stage")G.stages.push(J),J=[];else J.push(K);if(W==z.parsed.length-1)G.stages.push(J)}return G}var N={x:"l0ckbox",j:"l0ckjaw",q:"l0cket",a:"acct_nt",m:"magnara",W:"l0g_wr1t3r",o:"sn_w_usac",f:"shfflr",N:"CON_TELL",n:"CON_SPEC",D:"DATA_CHECK",g:"sn_w_glock","2":"ez_21","3":"ez_35","4":"ez_40",X:"c001",y:"c002",Y:"c003",C:"cron_bot",c:"char_count",s:"script_slot",S:"public_script","0":"channel_count",k:"k3y",b:"balance",w:"log_writer",t:"transactions",T:"transfer",u:"expose_upgrades",U:"transfer_upgrade",l:"expose_access_log",L:"expose_upgrade_log",z:"w4rn",Z:"w4rn_message",r:"w4rn_er"},y,I;function v(_,z){return U(_,w(z))}function U(_,z){y={};for(let K in N)y[K]=N[K];S(_);for(let K=0;K<_.length;K++)_[K]._rank=K;let G=[],J=[];for(let K of z.stages){let O=Date.now(),Z=O;I=[..._];for(let P of I)delete P._filtered;for(let P of K){if(P.type=="return"){if(I=I.filter((j)=>!j._filtered),I.length==0)break;continue}if(P.type=="alias"){y[P.data.k]=P.data.v;continue}if(P.type="rule"){if(!P.data)throw Error("Wtf?");let j=[];for(let D of I){if(!P.data.filters){j.push(D);continue}if(K0(D,P.data.filters))j.push(D)}let Q=(P.data.filters||[]).find((D)=>D._best!==void 0),q=(P.data.filters||[]).find((D)=>D._worst!==void 0);if(Q&&typeof Q._best=="number")j=d(j,Q._best,!1,Q.negative===!0);else if(q&&typeof q._worst=="number")j=d(j,q._worst,!0,q.negative===!0);for(let D of j){if(!G.includes(D))G.push(D);if(D._filtered=!0,P.data.actions)W0(D,P.data.actions)}}}Z=Date.now(),J.push(Z-O)}for(let K of _)delete K._filtered;let W=0;for(let K of J)W+=K;return{filtered:G,filterTimes:J,filterTime:W}}var T={};function E(_){if(_ in T)return T[_];let z=_.replace(/\_v\d$/gm,"").replace(/\_V\d$/gm,"");return T[_]=z,z}function f(_){if(!_.name)return 0;let z=E(_.name),G={k3y:_.k3y,CON_SPEC:_.p2_len,acct_nt:_.acct_nt_min,sn_w_glock:_.expire_secs,sn_w_usac:_.salt_digits,magnara:_.magnara_len,shfflr:_.digits,l0g_wr1t3r:_.loc_count,w4rn_message:_.cooldown,DATA_CHECK:_.acc_mod,l0cket:_.count,l0ckbox:_.count,l0ckjaw:_.count,balance:_.cooldown,expose_access_log:_.count,expose_upgrade_log:_.count,expose_upgrades:_.cooldown,log_writer:_.cooldown,transactions:_.count,transfer_upgrade:_.count,transfer:_.amount,channel_count:_.count,char_count:_.chars,public_script:_.slots,script_slot:_.slots,cron_bot:_.cooldown};if(z in G)return G[z];return 0}function x(_){if(!_.name)return 0;let z=E(_.name);if(z=="k3y"){if(!_.rarity)return 0;if(_.rarity==0)return 3;if(_.rarity==1)return 2;if(_.rarity>=2)return 1}let G={CON_SPEC:_.p2_len,acct_nt:_.acct_nt_min,sn_w_usac:_.salt_digits,magnara:_.magnara_len,shfflr:_.digits,l0g_wr1t3r:_.loc_count,DATA_CHECK:_.acc_mod,l0cket:_.count,l0ckbox:_.count,l0ckjaw:_.count,expose_access_log:_.count,expose_upgrade_log:_.count,transactions:_.count,transfer_upgrade:_.count,transfer:_.amount,channel_count:_.count,char_count:_.chars,public_script:_.slots,script_slot:_.slots,sn_w_glock:-_.expire_secs,w4rn_message:-_.cooldown,balance:-_.cooldown,expose_upgrades:-_.cooldown,log_writer:-_.cooldown,cron_bot:-_.cooldown};if(z in G)return G[z];return 1}function G0(_){if(!_.last_time||!_.cooldown)return-1;return _.cooldown*1000-(Date.now()-_.last_time)}function H0(_){return G0(_)<=0}function o(_,z){if(z===void 0)return!0;else if(typeof z=="number"||typeof z=="boolean")return _===z;else if(z=="undefined")return _===void 0;else if(typeof z=="string")return _===z;else if(z.type=="range")if(typeof _=="number"){let G=!0;if(_==null)return!1;if(z.min!=null&&_<z.min)G=!1;if(z.max!=null&&_>z.max)G=!1;return G}else return!1;return!1}function J0(_,z){if(!_._short)return!1;return y[z]==_._short}function K0(_,z){for(let G of z){let J=G.negative==!0;if(G.filterType=="sun"){if(G.alias&&!J0(_,G.alias)!==J)return!1;if(G.ready!=null&&G.ready!=H0(_)!==J)return!1;if(G.value!=null&&!o(_._value,G.value)!==J)return!1}for(let W in G){if(["_best","_worst","alias","ready","value","next_stage","filterType"].includes(W))continue;let K=G[W];if(K!=null&&!o(_[W],K)!==J)return!1}}return!0}function P0(_,z){if(!_.name)return 0;if(!z.name)return 0;if(_._short!=z._short)return 0;let G=_._quality,J=z._quality;if(G!==void 0&&J!==void 0&&J!=G)return J-G;return 0}function d(_,z,G,J){if(G&&J)return _.slice(0,_.length-z);else if(G&&!J)return _.slice(_.length-z);else if(!G&&J)return _.slice(z);else if(!G&&!J)return _.slice(0,z);return[]}function W0(_,z){for(let G of z)if(_[G.k]=G.v,G.v=="undefined")delete _[G.k]}function S(_){for(let z of _){if(z.name)z._short=E(z.name);if(!z._priority)z._priority=0;z._value=f(z),z._quality=x(z)}return _.sort((z,G)=>{if(z._short!==void 0&&G._short!==void 0&&z._short!=G._short)return z._short.localeCompare(G._short);let J=P0(z,G);if(J!=0)return J;if(z.tier!==void 0&&G.tier!==void 0&&z.tier!=G.tier)return G.tier-z.tier;if(z.rarity!==void 0&&G.rarity!==void 0&&z.rarity!=G.rarity)return G.rarity-z.rarity;if(z.loaded!==void 0&&G.loaded!==void 0&&z.loaded!=G.loaded)return G.loaded?1:0;if(z.price!==void 0&&G.price!==void 0&&z.price!=G.price)return z.price-G.price;if(z._priority!=G._priority)return G._priority-z._priority;if(z.sn!==void 0&&G.sn!==void 0&&z.sn!==G.sn)return z.sn.localeCompare(G.sn);return 0})}function X0(_){if(_&&_.import===!0)return{compile:w,filter:U,compileAndFilter:v,sortUpgrades:S,getUpgradeValue:f,getUpgradeQuality:x,Aliases:N};return(`    'J╔══════════════════════════════════════════════════════════════╗'    
    'J║'  cake.sun - Short Upgrade Notation                           'J║'   
    'J╠══════════════════════════════════════════════════════════════╣'    
    'J║'                                                              'J║'   
    'J║'  'I\\ | /                -= SUNSCRIPT =-'                        'J║'
    'J║'  'I- O -        A smart filter for your upgrades'               'J║'
    'J║'  'I/ | \\                 Keep it light'                         'J║'
    'J║'                                                              'J║'   
    'J║'  'IAll info is at https:`+"\/\/"+`github.com/CakeEaterGames/sunscript'  'J║'
    'J║                                                              ║'    
    'J╚══════════════════════════════════════════════════════════════╝'    `).replace(/'/gm,"`")}__main__=X0;})();

  return __main__(args);
}