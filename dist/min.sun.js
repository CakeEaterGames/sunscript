function(context,args){ // 
  var __main__;
(()=>{function O(f){if(f===void 0)return!1;for(let $=0;$<f.length;$++){let t=f[$].charCodeAt(0);if(!(t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||"_".includes(f[$])))return!1}return!0}function p(f){let $=[],t=f.split(`
`);for(let i of t){let P=i,j="\/\/";if(i.includes(j))i=i.substring(0,i.indexOf(j));let l=i.split(";");for(let G of l){if(G=G.trim(),!G)continue;let y=tf(G);$.push({raw:P,tokens:y})}}return $}function tf(f){let t=["->","---",..."=!:;+-^~>[]*"];function i(G,y,K){return G.substring(K,K+y.length)==y}let P=" 	\r",j=[],l="";f:for(let G=0;G<f.length;G++){let y=f[G];if(P.includes(y)){while(P.includes(y)){G++,y=f[G];continue}j.push(" ")}for(let Y of t)if(i(f,Y,G)){j.push(Y),G+=Y.length-1;continue f}if(y=='"'){let Y=y;do G++,y=f[G],Y+=y;while(y!='"');j.push(Y);continue}let K=y;G++,y=f[G];while(O(y))K+=y,G++,y=f[G];G--,j.push(K)}if(j.length>0&&j[j.length-1]!=";")j.push(";");return j}function D(f,$,t="",i=""){return n(`${t}Expected any of ["${f.join('", "')}"]. But recieved: "${$}". ${i}`)}var U=[],_=U[0],C=0;function s(f){let $=p(f),t=[],i=[];for(let P of $){U=P.tokens,_=U[0],C=0;let j=hf();if(j.type=="error")i.push({line:P.raw,error:j.error});else t.push(...j.value)}return{errors:i,parsed:t}}function M(f){}function z(){if(C++,_=U[C],_===void 0)_=";";return M("Advanced: "+_),_}function $f(f){return U[C+f]}function x(){return C>=U.length}function r(){return{curI:C,cur:_}}function _f(f){C=f.curI,_=f.cur}function Z(f){if(M("consume "+f),_!=f)return D([f],_);M("consumed");let $=_;return z(),H(void 0)}function J(){while(_==" ")z()}function H(f){return{type:"success",value:f}}function n(f){return M(f),{type:"error",error:f}}function hf(){M("parseScriptLine"),J();let f=[];while(!x()){while(_==";")z();if(x())return H(f);let $=Ff();if($.type=="error")return $;if($.value)f.push($.value)}return H(f)}function Ff(){M("parseCMD"),J();let f={};if(_==">"){f.type="return",z(),J();let i=Z(";");if(i.type=="error")return i;return H(f)}if(_=="---"){f.type="stage",z(),J();let i=Z(";");if(i.type=="error")return i;return H(f)}if(_=="alias"){f.type="alias";let i=yf();if(i.type=="error")return i;return f.data=i.value,H(f)}let $={};f.type="rule",f.data=$;let t=zf();if(t.type=="error")return t;if($.filters=t.value,J(),_==";")return z(),H(f);if(J(),_=="->"){z();let i=jf();if(i.type=="error")return i;$.actions=i.value,J();let P=Z(";");if(P.type=="error")return P}if($.actions&&$.actions.length==0)delete $.actions;if($.filters&&$.filters.length==0)delete $.filters;return H(f)}function jf(){M("parseActions");let f=[];while(!0){if(J(),_==";")return H(f);let $=Pf();if($.type=="error")return $;f.push($.value)}}function Pf(){M("parseAction"),J();let f=!1;if(_=="!")f=!0,z(),J();if(!O(_))return D(["alphanumeric string"],_,"Action error. ");let $=_;if(z(),J(),O(_)||_==";"){let t=!0;if(f)t="undefined";return H({k:$,v:t})}else if(_=="="){z(),J();let t=q();if(t.type=="error")return t;let i=t.value;return z(),H({k:$,v:i})}else return D("=; ".split(""),_)}function yf(){M("parseAlias");let f=Z("alias");if(f.type=="error")return f;if(f=Z(" "),f.type=="error")return f;if(J(),_.length!=1)return D(["single alphanumeric character"],_,"Alias error. ");let $=_;if(z(),J(),f=Z("="),f.type=="error")return f;if(J(),!O(_))return D(["alphanumeric string"],_,"Alias error. ");let t=_;if(z(),J(),f=Z(";"),f.type=="error")return f;return H({k:$,v:t})}function zf(){M("parseFilters"),J();let f=[],$=r(),t=c(),i=Bf(),P=!1;if(i.type=="error")_f($),P=!0;else{if(t.type=="success"&&t.value===!0)i.value.negative=t.value;f.push(i.value)}J();while(!(_=="->"||_==";"||x())){let j=c(),l=Gf();if(l.type=="error"&&i.type=="error"&&P)return n(i.error);if(l.type=="error")return l;if(j.type=="success"&&j.value===!0)l.value.negative=j.value;f.push(l.value),J(),P=!1}return H(f)}function c(){if(J(),_=="!")return z(),H(!0);else return H(!1)}function Bf(){M("parseSUN");let f={filterType:"sun",negative:void 0,loaded:void 0,ready:void 0,alias:void 0,tier:void 0,rarity:void 0,value:void 0};if(_=="+")f.loaded=!0,z();else if(_=="-")f.loaded=!1,z();if(_=="^")f.ready=!0,z();else if(_=="~")f.ready=!1,z();if(!O(_)&&_!="*")return D(["alias char"],_,"SUN Rule error. ");switch(_.length){case 3:{if(f.alias=_[0],isNaN(Number(_[1])))return D(["number"],_[1],"SUN Rule error. ");if(isNaN(Number(_[2])))return D(["number"],_[2],"SUN Rule error. ");f.tier=Number(_[1]),f.rarity=Number(_[2]),z()}break;case 2:{if(f.alias=_[0],isNaN(Number(_[1])))return D(["number"],_[1],"SUN Rule error. ");if(f.tier=Number(_[1]),z(),_=="*")Z("*");else if(_==" ");else if((_+"").length==1&&!isNaN(Number(_)))f.rarity=Number(_),z()}break;case 1:{if(f.alias=_[0],z(),_=="*")Z("*");else if(_==" ");else if((_+"").length==1&&!isNaN(Number(_)))f.tier=Number(_),z();else if((_+"").length==2&&!isNaN(Number(_))){f.tier=Number(_[0]),f.rarity=Number(_[1]),z();break}if(_=="*")Z("*");else if(_==" ");else if((_+"").length==1&&!isNaN(Number(_)))f.rarity=Number(_),z()}break;default:return D(["alias char"],_,"SUN Rule error. ")}if(f.alias=="*")f.alias=void 0;if(_=="["){Z("[");let $=a();if($.type=="error")return $;if($.value!="*")f.value=$.value;let t=Z("]");if(t.type=="error")return t}if(_!=" "&&_!=";"&&_!="->")return D(["->",";"," "],_,"SUN Rule error. ");if(J(),f.loaded===void 0)delete f.loaded;if(f.negative===void 0)delete f.negative;if(f.rarity===void 0)delete f.rarity;if(f.ready===void 0)delete f.ready;if(f.tier===void 0)delete f.tier;if(f.value===void 0)delete f.value;return H(f)}function Gf(){M("parseLUN");let f={filterType:"lun",negative:void 0};if(!O(_))return D(["alphanumeric string"],_,"LUN Rule error. ");let $=_;z();let t=r();if(J(),_=="="){let i=Z("=");if(i.type=="error")return i;J();let P=a();if(P.type=="error")return P;return f[$]=P.value,H(f)}else if([";","->","!"].includes(_)||O(_))return f[$]=!0,H(f);else return D(["=",";","->","!"],_,"LUB Rule error. ")}function a(){if(M("parseValue"),$f(1)==":"){let f=Hf();if(f.type=="error")return f;if(f.value.min==null&&f.value.max==null)return H(void 0);return f}else{let f=q();if(f.type=="error")return f;if(f.value==null)return H(void 0);return H(f.value)}}function q(){M("parseValueType");let f=_;if(!isNaN(Number(f)))return z(),H(Number(f));if(f[0]=='"'&&f[f.length-1]=='"')return f=f.replace(/\"/gm,""),z(),H(f);if(O(f)){if(f=="true")f=!0;if(f=="false")f=!1;return z(),H(f)}if(f=="*")return f=void 0,z(),H(f);return n("Failed to parse value "+f)}function Hf(){let f=q();if(f.type=="error")return f;if(typeof f.value!="number"&&f.value!==void 0)f.value=Number(f.value);let $=Z(":");if($.type=="error")return $;let t=q();if(t.type=="error")return t;if(typeof t.value!="number"&&t.value!==void 0)t.value=Number(t.value);return H({type:"range",min:f.value,max:t.value})}function A(f){let $=s(f);if($.errors.length>0)throw $.errors;let t={stages:[]},i=[];for(let P=0;P<$.parsed.length;P++){let j=$.parsed[P];if(j.type=="stage")t.stages.push(i),i=[];else i.push(j);if(P==$.parsed.length-1)t.stages.push(i)}return t}var L={x:"l0ckbox",j:"l0ckjaw",q:"l0cket",a:"acct_nt",m:"magnara",W:"l0g_wr1t3r",o:"sn_w_usac",f:"shfflr",N:"CON_TELL",n:"CON_SPEC",D:"DATA_CHECK",g:"sn_w_glock","2":"ez_21","3":"ez_35","4":"ez_40",X:"c001",y:"c002",Y:"c003",C:"cron_bot",c:"char_count",s:"script_slot",S:"public_script","0":"channel_count",k:"k3y",b:"balance",w:"log_writer",t:"transactions",T:"transfer",u:"expose_upgrades",U:"transfer_upgrade",l:"expose_access_log",L:"expose_upgrade_log",z:"w4rn",Z:"w4rn_message",r:"w4rn_er"},V,I;function ff(f,$){return b(f,A($))}function b(f,$){V={};for(let j in L)V[j]=L[j];v(f);let t=[],i=[];for(let j of $.stages){let l=Date.now(),G=l;I=[...f];for(let y of I)delete y._filtered;for(let y of j){if(y.type=="return"){if(I=I.filter((K)=>!K._filtered),I.length==0)break;continue}if(y.type=="alias"){V[y.data.k]=y.data.v;continue}if(y.type="rule"){if(!y.data)throw Error("Wtf?");let K=[];for(let F of I){if(!y.data.filters){K.push(F);continue}if(Xf(F,y.data.filters))K.push(F)}let Y=(y.data.filters||[]).find((F)=>F._best!==void 0),h=(y.data.filters||[]).find((F)=>F._worst!==void 0);if(Y&&typeof Y._best=="number")K=T(K,Y._best,!1,Y.negative===!0);else if(h&&typeof h._worst=="number")K=T(K,h._worst,!0,h.negative===!0);for(let F of K){if(!t.includes(F))t.push(F);if(F._filtered=!0,y.data.actions)Zf(F,y.data.actions)}}}G=Date.now(),i.push(G-l)}for(let j of f)delete j._filtered;let P=0;for(let j of i)P+=j;return{filtered:t,filterTimes:i,filterTime:P}}var g={};function k(f){if(f in g)return g[f];let $=f.replace(/\_v\d$/gm,"").replace(/\_V\d$/gm,"");return g[f]=$,$}function m(f){if(!f.name)return 0;let $=k(f.name),t={k3y:f.k3y,CON_SPEC:f.p2_len,acct_nt:f.acct_nt_min,sn_w_glock:f.expire_secs,sn_w_usac:f.salt_digits,magnara:f.magnara_len,shfflr:f.digits,l0g_wr1t3r:f.loc_count,w4rn_message:f.cooldown,DATA_CHECK:f.acc_mod,l0cket:f.count,l0ckbox:f.count,l0ckjaw:f.count,balance:f.cooldown,expose_access_log:f.count,expose_upgrade_log:f.count,expose_upgrades:f.cooldown,log_writer:f.cooldown,transactions:f.count,transfer_upgrade:f.count,transfer:f.amount,channel_count:f.count,char_count:f.chars,public_script:f.slots,script_slot:f.slots,cron_bot:f.cooldown};if($ in t)return t[$];return 0}function d(f){if(!f.name)return 0;let $=k(f.name);if($=="k3y"){if(!f.rarity)return 0;if(f.rarity==0)return 3;if(f.rarity==1)return 2;if(f.rarity>=2)return 1}let t={CON_SPEC:f.p2_len,acct_nt:f.acct_nt_min,sn_w_usac:f.salt_digits,magnara:f.magnara_len,shfflr:f.digits,l0g_wr1t3r:f.loc_count,DATA_CHECK:f.acc_mod,l0cket:f.count,l0ckbox:f.count,l0ckjaw:f.count,expose_access_log:f.count,expose_upgrade_log:f.count,transactions:f.count,transfer_upgrade:f.count,transfer:f.amount,channel_count:f.count,char_count:f.chars,public_script:f.slots,script_slot:f.slots,sn_w_glock:-f.expire_secs,w4rn_message:-f.cooldown,balance:-f.cooldown,expose_upgrades:-f.cooldown,log_writer:-f.cooldown,cron_bot:-f.cooldown};if($ in t)return t[$];return 1}function Jf(f){if(!f.last_time||!f.cooldown)return-1;return f.cooldown*1000-(Date.now()-f.last_time)}function Kf(f){return Jf(f)<=0}function u(f,$){if($===void 0)return!0;else if(typeof $=="number"||typeof $=="boolean")return f===$;else if($=="undefined")return f===void 0;else if(typeof $=="string")return f===$;else if($.type=="range")if(typeof f=="number"){let t=!0;if(f==null)return!1;if($.min!=null&&f<$.min)t=!1;if($.max!=null&&f>$.max)t=!1;return t}else return!1;return!1}function Wf(f,$){if(!f._short)return!1;return V[$]==f._short}function Xf(f,$){for(let t of $){let i=t.negative==!0;if(t.filterType=="sun"){if(t.alias&&!Wf(f,t.alias)!==i)return!1;if(t.ready!=null&&t.ready!=Kf(f)!==i)return!1;if(t.value!=null&&!u(f._value,t.value)!==i)return!1}for(let P in t){if(["_best","_worst","alias","ready","value","next_stage","filterType"].includes(P))continue;let j=t[P];if(j!=null&&!u(f[P],j)!==i)return!1}}return!0}function Yf(f,$){if(!f.name)return 0;if(!$.name)return 0;if(f._short!=$._short)return 0;let t=f._quality,i=$._quality;if(t!==void 0&&i!==void 0&&i!=t)return i-t;return 0}function T(f,$,t,i){if(t&&i)return f.slice(0,f.length-$);else if(t&&!i)return f.slice(f.length-$);else if(!t&&i)return f.slice($);else if(!t&&!i)return f.slice(0,$);return[]}function Zf(f,$){for(let t of $)if(f[t.k]=t.v,t.v=="undefined")delete f[t.k]}function v(f){for(let t of f){if(t.name)t._short=k(t.name);if(!t._priority)t._priority=0;t._value=m(t),t._quality=d(t)}function $(t,i){if(t._short!==void 0&&i._short!==void 0&&t._short!=i._short)return t._short.localeCompare(i._short);let P=Yf(t,i);if(P!=0)return P;if(t.tier!==void 0&&i.tier!==void 0&&t.tier!=i.tier)return i.tier-t.tier;if(t.rarity!==void 0&&i.rarity!==void 0&&t.rarity!=i.rarity)return i.rarity-t.rarity;if(t.loaded!==void 0&&i.loaded!==void 0&&t.loaded!=i.loaded)return i.loaded?1:-1;if(t.price!==void 0&&i.price!==void 0&&t.price!=i.price)return t.price-i.price;if(t._priority!=i._priority)return i._priority-t._priority;if(t.sn!==void 0&&i.sn!==void 0&&t.sn!==i.sn)return t.sn.localeCompare(i.sn);return 0}f.sort($);for(let t=0;t<f.length;t++)f[t]._rank=t;return f}var e;((Lf)=>{function f(h){let F=$(h);return console.log(F),F}Lf.transpile=f;function $(h,F=!0){let X=[];for(let w of h.stages)X.push(t(w));let B=`
function filter(ups){
const t = true;
${T.toString()}
let original = ups
SUN.sortUpgrades(original)
let a = {}
for (const k in SUN.Aliases) {
  a[k] = SUN.Aliases[k]
}
${X.join(i())}
}
`;if(F)B=B.replace(/\_filtered/gm,"_"),B=B.replace(/\btrue\b/gm,"t");return B}function t(h){let F="";F=`cur = original
`;for(let X of h)switch(X.type){case"rule":F+=l(X.data);break;case"alias":F+=j(X.data);break;case"return":F+=P();break}return F}function i(){return`for (let u of cur) delete u._filtered

`}function P(){return`cur = cur.filter(u=>!u._filtered)
`}function j(h){return`a.${h.k} = "${h.v}"
`}function l(h){let F="",X=[],B=[];for(let R of h.filters||[])X.push(G(R));for(let R of h.actions||[])B.push(y(R));B.push("u._filtered = true");let w=B.join(`
`),Q=X.filter((R)=>R.trim()).join(" && "),W=h.filters?.find((R)=>R._best),N=h.filters?.find((R)=>R._worst),o,E;if(W)o=W._best,E=!!W.negative;if(N)o=N._worst,E=!!N.negative;if(!Q.trim())Q="true";let S;if(W||N)S=`filterBest(cur.filter(u=>${Q}),${o},${!!N},${E})`;else S=`cur.filter(u=>${Q})`;return`for (const u of ${S}){
${w}
}
`}function G(h){let F=[];switch(h.filterType){case"sun":F.push(K(h));break;case"lun":F.push(Y(h));break}return F.filter((X)=>X.trim()).join(" && ")}function y(h){let F="";if(h.v=="undefined"||h.v==null)return`delete u.${h.k}`;if(typeof h.v=="string")return`u.${h.k} = "${h.v}"`;return`u.${h.k} = ${h.v}`}function K(h){let F={};if(F.negative=h.negative,h.filterType,h.alias)F.alias=h.alias;if(h.tier)F.tier=h.tier;if(h.rarity)F.rarity=h.rarity;if(h.loaded!==void 0)F.loaded=h.loaded;if(h.value)F._value=h.value;if(h.ready)F._ready=h.ready;if(h.negative)F.negative=h.negative;return Y(F)}function Y(h){let F="",X=[];for(let B in h){if(B=="filterType")continue;if(B=="negative")continue;let w=h.negative?"!":"",Q="u."+B,W="";if(B=="alias")Q="u._short",W=`==aliases.${h[B]}`;else if(B=="_best")continue;else if(B=="_worst")continue;else if(h[B]==="undefined")W="",w+="!";else if(h[B]===!0)W="";else if(typeof h[B]=="string")W=`=="${h[B]}"`;else if(h[B]&&h[B].type==="range"){Q="",W="";let N=h[B];if(N.min!=null)W+=`u.${B} >= ${N.min}`;if(N.max!=null){if(W)W+=" && ";W+=`u.${B} <= ${N.max}`}}else W=`==${h[B]}`;if(w)X.push(`${w}(${Q}${W})`);else X.push(`${Q}${W}`)}return X.filter((B)=>B.trim()).join(" && ")}})(e||={});function Mf(f){if(f&&f.import===!0)return{compile:A,transpile:e.transpile,filter:b,compileAndFilter:ff,sortUpgrades:v,getUpgradeValue:m,getUpgradeQuality:d,Aliases:L};return(`    'J╔══════════════════════════════════════════════════════════════╗'    
    'J║'  cake.sun - Short Upgrade Notation                           'J║'   
    'J╠══════════════════════════════════════════════════════════════╣'    
    'J║'                                                              'J║'   
    'J║'  'I\\ | /                -= SUNSCRIPT =-'                        'J║'
    'J║'  'I- O -        A smart filter for your upgrades'               'J║'
    'J║'  'I/ | \\                 Keep it light'                         'J║'
    'J║'                                                              'J║'   
    'J║'  'IAll info is at https:`+"\/\/"+`github.com/CakeEaterGames/sunscript'  'J║'
    'J║                                                              ║'    
    'J╚══════════════════════════════════════════════════════════════╝'    `).replace(/'/gm,"`")}__main__=Mf;})();

  return __main__(args);
}