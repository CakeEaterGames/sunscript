function(context,args){ // 
  var __main__;
(()=>{function h(t){if(t===void 0)return!1;for(let o=0;o<t.length;o++){let n=t[o].charCodeAt(0);if(!(n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122||"_".includes(t[o])))return!1}return!0}function F(t){let o=[],n=t.split(`
`);for(let f of n){let l=f,i="\/\/";if(f.includes(i))f=f.substring(0,f.indexOf(i));let b=f.split(";");for(let d of b){if(d=d.trim(),!d)continue;let _=M(d);o.push({raw:l,tokens:_})}}return o}function M(t){let n=["->",..."=!:;+-^~>[]*"];function f(d,_,D){return d.substring(D,D+_.length)==_}let l=" \t\r",i=[],b="";t:for(let d=0;d<t.length;d++){let _=t[d];if(l.includes(_)){while(l.includes(_)){d++,_=t[d];continue}i.push(" ")}for(let O of n)if(f(t,O,d)){i.push(O),d+=O.length-1;continue t}if(_=='"'){let O=_;do d++,_=t[d],O+=_;while(_!='"');i.push(O);continue}let D=_;d++,_=t[d];while(h(_))D+=_,d++,_=t[d];d--,i.push(D)}if(i.length>0&&i[i.length-1]!=";")i.push(";");return i}function U(t,o,n="",f=""){return P(`${n}Expected any of ["${t.join('", "')}"]. But recieved: "${o}". ${f}`)}var s=[],e=s[0],C=0;function $(t){let o=F(t),n=[],f=[];for(let l of o){s=l.tokens,e=s[0],C=0;let i=V();if(i.type=="error")f.push({line:l.raw,error:i.error});else n.push(...i.value)}return{errors:f,parsed:n}}function y(t){}function g(){if(C++,e=s[C],e===void 0)e=";";return y("Advanced: "+e),e}function a(t){return s[C+t]}function K(){return C>=s.length}function B(){return{curI:C,cur:e}}function N(t){C=t.curI,e=t.cur}function m(t){if(y("consume "+t),e!=t)return U([t],e);y("consumed");let o=e;return g(),r(void 0)}function w(){while(e==" ")g()}function r(t){return{type:"success",value:t}}function P(t){return y(t),{type:"error",error:t}}function V(){y("parseScriptLine"),w();let t=[];while(!K()){while(e==";")g();if(K())return r(t);let o=E();if(o.type=="error")return o;if(o.value)t.push(o.value)}return r(t)}function E(){y("parseRule"),w();let t={};if(e==">"){t.return=!0,g(),w();let n=m(";");if(n.type=="error")return n;return r(t)}if(e=="pp"){g(),t.pp=!0;let n=m(" ");if(n.type=="error")return n;w()}if(e=="alias"){let n=c();if(n.type=="error")return n;return t.alias=n.value,r(t)}let o=k();if(o.type=="error")return o;if(t.filters=o.value,w(),e==";")return g(),r(t);if(w(),e=="->"){g();let n=I();if(n.type=="error")return n;t.actions=n.value,w();let f=m(";");if(f.type=="error")return f}return r(t)}function I(){y("parseActions");let t=[];while(!0){if(w(),e==";")return r(t);let o=L();if(o.type=="error")return o;t.push(o.value)}}function L(){y("parseAction"),w();let t={};if(!h(e))return U(["alphanumeric string"],e,"Action error. ");let o=e;if(g(),w(),h(e)||e==";")return r({k:o,v:!0});else if(e=="="){g(),w();let n=z();if(n.type=="error")return n;let f=n.value;return g(),r({k:o,v:f})}else return U("=; ".split(""),e)}function c(){y("parseAlias");let t=m("alias");if(t.type=="error")return t;if(t=m(" "),t.type=="error")return t;if(w(),e.length!=1)return U(["single alphanumeric character"],e,"Alias error. ");let o=e;if(g(),w(),t=m("="),t.type=="error")return t;if(w(),!h(e))return U(["alphanumeric string"],e,"Alias error. ");let n=e;if(g(),w(),t=m(";"),t.type=="error")return t;return r({v:o,k:n})}function k(){y("parseFilters"),w();let t=[],o=B(),n=R(),f=S(),l=!1;if(f.type=="error")N(o),l=!0;else{if(n.type=="success"&&n.value===!0)f.value.negative=n.value;t.push(f.value)}w();while(!(e=="->"||e==";"||K())){let i=R(),b=u();if(b.type=="error"&&f.type=="error"&&l)return P(f.error);if(b.type=="error")return b;if(i.type=="success"&&i.value===!0)b.value.negative=i.value;t.push(b.value),w(),l=!1}return r(t)}function R(){if(w(),e=="!")return g(),r(!0);else return r(!1)}function S(){y("parseSUN");let t={type:"sun",negative:void 0,loaded:void 0,ready:void 0,alias:void 0,tier:void 0,rarity:void 0,value:void 0};if(e=="+")t.loaded=!0,g();else if(e=="-")t.loaded=!1,g();if(e=="^")t.ready=!0,g();else if(e=="~")t.ready=!1,g();if(!h(e)&&e!="*")return U(["alias char"],e,"SUN Rule error. ");switch(e.length){case 3:{if(t.alias=e[0],!isNaN(Number(e[1])))t.tier=Number(e[1]);if(!isNaN(Number(e[2])))t.rarity=Number(e[2]);g()}break;case 2:{if(t.alias=e[0],!isNaN(Number(e[1])))t.tier=Number(e[1]);if(g(),e=="*")m("*");else if(e==" ");else if((e+"").length==1&&!isNaN(Number(e)))t.rarity=Number(e),g()}break;case 1:{if(t.alias=e[0],g(),e=="*")m("*");else if(e==" ");else if((e+"").length==1&&!isNaN(Number(e)))t.tier=Number(e),g();if(e=="*")m("*");else if(e==" ");else if((e+"").length==1&&!isNaN(Number(e)))t.rarity=Number(e),g()}break;default:return U(["alias char"],e,"SUN Rule error. ")}if(t.alias=="*")t.alias=void 0;if(e=="["){m("[");let o=Q();if(o.type=="error")return o;if(o.value!="*")t.value=o.value;let n=m("]");if(n.type=="error")return n}if(e!=" "&&e!=";"&&e!="->")return U(["->",";"," "],e,"SUN Rule error. ");if(g(),t.loaded===void 0)delete t.loaded;if(t.negative===void 0)delete t.negative;if(t.rarity===void 0)delete t.rarity;if(t.ready===void 0)delete t.ready;if(t.tier===void 0)delete t.tier;if(t.value===void 0)delete t.value;return r(t)}function u(){y("parseLUN");let t={type:"lun",negative:void 0};if(!h(e))return U(["alphanumeric string"],e,"LUN Rule error. ");let o=e;g();let n=B();if(w(),e=="="){let f=m("=");if(f.type=="error")return f;w();let l=Q();if(l.type=="error")return l;return t[o]=l.value,r(t)}else if([";","->","!"].includes(e)||h(e))return t[o]=!0,r(t);else return U(["=",";","->","!"],e,"LUB Rule error. ")}function Q(){if(y("parseValue"),a(1)==":"){let t=p();if(t.type=="error")return t;if(t.value.min==null&&t.value.max==null)return r(void 0);return t}else{let t=z();if(t.type=="error")return t;if(t.value==null)return r(void 0);return r(t.value)}}function z(){y("parseValueType");let t=e;if(!isNaN(Number(t)))return g(),r(Number(t));if(t[0]=='"'&&t[t.length-1]=='"')return t=t.replace(/\"/gm,""),g(),r(t);if(h(t)){if(t=="true")t=!0;if(t=="false")t=!1;return g(),r(t)}if(t=="*")return t=void 0,g(),r(t);return P("Failed to parse value "+t)}function p(){let t=z();if(t.type=="error")return t;if(typeof t.value!="number"&&t.value!==void 0)t.value=Number(t.value);let o=m(":");if(o.type=="error")return o;let n=z();if(n.type=="error")return n;if(typeof n.value!="number"&&n.value!==void 0)n.value=Number(n.value);return r({type:"range",min:t.value,max:n.value})}function W(t){let o=$(t);if(o.errors.length>0)throw o.errors;let n=o.parsed.filter((l)=>!l.pp),f=o.parsed.filter((l)=>l.pp);return{stages:[n,f]}}var j={l0ckbox:"x",l0ckjaw:"j",l0cket:"q",acct_nt:"a",magnara:"m",l0g_wr1t3r:"W",sn_w_usac:"o",shfflr:"f",CON_TELL:"N",CON_SPEC:"n",DATA_CHECK:"D",sn_w_glock:"g",ez_21:"2",ez_35:"3",ez_40:"4",c001:"X",c002:"y",c003:"Y",cron_bot:"C",char_count:"c",script_slot:"s",public_script:"S",channel_count:"0",k3y:"k",balance:"b",log_writer:"w",transactions:"t",transfer:"T",expose_upgrades:"u",transfer_upgrade:"U",expose_access_log:"l",expose_upgrade_log:"L",w4rn:"z",w4rn_message:"Z",w4rn_er:"r"},A,T;function Z(t,o){A={};for(let f in j)A[f]=j[f];let n=!1;for(let f of o.stages){T=[...t];for(let l of f){if(l.return){if(T=T.filter((_)=>!_._filtered),T.length==0)break;continue}if(l.alias){A[l.alias.k]=l.alias.v;continue}let i=[];for(let _ of T)if(l.filters&&ot(_,l.filters))i.push(_),n=!0;let b=(l.filters||[]).find((_)=>_._best!==void 0),d=(l.filters||[]).find((_)=>_._worst!==void 0);if(b&&typeof b._best=="number")i=Y(i,b._best,!1,b.negative===!0);else if(d&&typeof d._worst=="number")i=Y(i,d._worst,!0,d.negative===!0);for(let _ of i)if(_._filtered=!0,l.actions)et(_,l.actions)}}}function q(t){return t.replace(/\_v\d$/gm,"").replace(/\_V\d$/gm,"")}function x(t){let o=q(t.name),n={k3y:t.k3y,CON_SPEC:t.p2_len,acct_nt:t.acct_nt_min,sn_w_glock:t.expire_secs,sn_w_usac:t.salt_digits,magnara:t.magnara_len,shfflr:t.digits,l0g_wr1t3r:t.loc_count,w4rn_message:t.cooldown,DATA_CHECK:t.acc_mod,l0cket:t.count,l0ckbox:t.count,l0ckjaw:t.count,balance:t.cooldown,expose_access_log:t.count,expose_upgrade_log:t.count,expose_upgrades:t.cooldown,log_writer:t.cooldown,transactions:t.count,transfer_upgrade:t.count,transfer:t.amount,channel_count:t.count,char_count:t.chars,public_script:t.slots,script_slot:t.slots,cron_bot:t.cooldown};if(o in n)return n[o];return 0}function H(t){let o=q(t.name);if(o=="k3y"){if(t.rarity==0)return 3;if(t.rarity==1)return 2;if(t.rarity>=2)return 1}let n={CON_SPEC:t.p2_len,acct_nt:t.acct_nt_min,sn_w_usac:t.salt_digits,magnara:t.magnara_len,shfflr:t.digits,l0g_wr1t3r:t.loc_count,DATA_CHECK:t.acc_mod,l0cket:t.count,l0ckbox:t.count,l0ckjaw:t.count,expose_access_log:t.count,expose_upgrade_log:t.count,transactions:t.count,transfer_upgrade:t.count,transfer:t.amount,channel_count:t.count,char_count:t.chars,public_script:t.slots,script_slot:t.slots,sn_w_glock:-t.expire_secs,w4rn_message:-t.cooldown,balance:-t.cooldown,expose_upgrades:-t.cooldown,log_writer:-t.cooldown,cron_bot:-t.cooldown};if(o in n)return n[o];return 1}function v(t){if(!t.last_time||!t.cooldown)return-1;return t.cooldown*1000-(Date.now()-t.last_time)}function tt(t){return v(t)<=0}function X(t,o){if(o===void 0)return!0;else if(typeof o=="number"||typeof o=="boolean")return t===o;else if(o=="undefined")return t===void 0;else if(typeof o=="string")return t===o;else if(o.type=="range")if(typeof t=="number"){let n=!0;if(t==null)return!1;if(o.min!=null&&t<o.min)n=!1;if(o.max!=null&&t>o.max)n=!1;return n}else return!1;return!1}function nt(t,o){let n=q(t.name);if(A[n]==o)return!0;return!1}function ot(t,o){for(let n of o){let f=n.negative==!0;if(n.type=="sun"){if(n.alias&&!nt(t,n.alias)!==f)return!1;if(n.ready!=null&&n.ready!=tt(t)!==f)return!1;if(n.value!=null&&!X(x(t),n.value)!==f)return!1}for(let l in n){if(["_best","_worst","alias","ready","value","pp","type"].includes(l))continue;let i=n[l];if(i!=null&&!X(t[l],i)!==f)return!1}}return!0}function G(t,o){let n=q(t.name),f=q(o.name),l=H(t),i=H(o);if(n!=f)return 0;if(n=="k3y"&&t.k3y!=o.k3y)return 0;return i-l}function Y(t,o,n,f){if(t.sort(G),n)t.reverse();if(!f)return t.slice(0,o);if(f)return t.slice(o);return[]}function et(t,o){for(let n of o)if(t[n.k]=n.v,n.v=="undefined")delete t[n.k]}function J(t){return t.sort((o,n)=>{if(o.name!=n.name)return o.name.localeCompare(n.name);let f=G(o,n);if(f!=0)return f;if(o.tier!=n.tier)return n.tier-o.tier;if(o.rarity!=n.rarity)return n.rarity-o.rarity;if(o.loaded!=n.loaded)return n.loaded?1:0;return 0})}function ft(t){if(t&&t.import===!0)return{compile:W,filter:Z,sortUpgrades:J,getUpgradeValue:x,getUpgradeQuality:H,Aliases:j};return(`    'J╔══════════════════════════════════════════════════════════════╗'    
    'J║'  cake.sun - Short Upgrade Notation                           'J║'   
    'J╠══════════════════════════════════════════════════════════════╣'    
    'J║'                                                              'J║'   
    'J║'  'I\\ | /                -= SUNSCRIPT =-'                        'J║'
    'J║'  'I- O -        A smart filter for your upgrades'               'J║'
    'J║'  'I/ | \\                 Keep it light'                         'J║'
    'J║'                                                              'J║'   
    'J║'  'IAll info is at https:`+"\/\/"+`github.com/CakeEaterGames/sunscript'  'J║'
    'J║                                                              ║'    
    'J╚══════════════════════════════════════════════════════════════╝'    `).replace(/'/gm,"`")}__main__=ft;})();

  return __main__(args);
}